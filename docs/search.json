[
  {
    "objectID": "index.html",
    "href": "index.html",
    "title": "Global Change and Emerging Infectious Disease",
    "section": "",
    "text": "Preface\nGlobal Change and Emerging Infectious Disease.\nThese are the course notes."
  },
  {
    "objectID": "R0.html",
    "href": "R0.html",
    "title": "1  That Basic Reproduction Number",
    "section": "",
    "text": "2 Elasticities\nSensitivities tell us about the absolute change in \\(R_0\\) given a small change in one of the entries in \\(\\mathbf{G}\\). Sometimes we want to know about the proportional sensitivities though. Use a trick invented by Carl Jacobi in the mid-nineteenth century. Define a proportional sensitivity (or elasticity) as\n\\[ e_{ij} = \\frac{g_{ij}}{R_0} \\cdot \\frac{\\partial R_0}{\\partial\n  g_{ij}} = \\frac{\\partial \\log(R_0)}{\\partial \\log(g_{ij})}.\n\\]\nElasticities answer the following question: if \\(g_{ij}\\) increases by 1%, by what percentage will \\(R_0\\) increase? Elasticities also have the convenient property of summing to one across all elements of the next generation matrix. They thus represent the fraction of the total potential reduction embodied in each cell of the next generation matrix (assuming everything else stays the same).\ncalc.elas &lt;- function(G){\n  ev &lt;- eigen(G)\n  lmax &lt;- which(Re(ev$values)==max(Re(ev$values)))\n  R0 &lt;- ev$values[lmax]\n  U &lt;- ev$vectors\n  u &lt;- abs(Re(U[,lmax]))\n  V &lt;- solve(Conj(U))\n  v &lt;- abs(Re(V[lmax,]))\n  \n  s &lt;- v%o%u\n  e &lt;- s*G/R0\n  return(e)\n}\n\n(E &lt;- calc.elas(G))\n\n           [,1]      [,2]       [,3]\n[1,] 0.00000000 0.4711538 0.02884615\n[2,] 0.47115385 0.0000000 0.00000000\n[3,] 0.02884615 0.0000000 0.00000000\nSo our elasticity matrix looks like this:\n\\[\n\\mathbf{E} = \\left[ \\begin{array}{ccc}\n0.00 & 0.47 & 0.03 \\\\\n0.47 & 0.00 & 0.00 \\\\\n0.03 & 0.00 & 0.00\n\\end{array} \\right].\n\\]\nTransmission from bugs to dogs and dogs to bugs accounts for more than 94% of the elasticity. Clearly, we need to stop the canine transmission cycle! The elasticities of all pairs (e.g., bugs to dogs/dogs to bugs) are identical because of a feature of elasticities identified by Groenendael et al. (1994). In brief, the sum of elasticities of the incoming transitions to a vertex in the transmission graph will equal the sum of the elasticities of the outgoing transitions. Because humans and dogs don’t infect each other, this means that the elasticities involving bugs and the two mammal species (i.e., humans, dogs) will be equal to each other. More later.\nAll of the examples so far have involved multi-host infections. There are many important ways that disease transmission is structured within human populations as well. For example, the transmission of respiratory infections like influenza is quite strongly age-structured (Hill and Longini 2003). Indeed, social categories can have a profound impact on the transmission dynamics of epidemics. Kucharski et al. (2014) show that during the 2009 H1N1 Influenza pandemic, infection risk among people in Hong Kong was more influenced by the average reported social mixing behavior of an individual’s age group, than it was by their own reported contacts. For easily-transmitted respiratory pathogens like influenza A, the aggregate patterns can overwhelm the particular behavior of individuals.\nWe can use sensitivity/elasticity analysis of the next-generation matrix to help us determine the categories of people on whom we should concentrate our epidemic-control efforts if we want to have maximum effect for a given effort.\nHill and Longini (2003) present a next-generation matrix for influenza-A transmission calculated from data presented in Longini, Ackerman, and Elveback (1978):\n\\[ \\mathbf{G} = \\left[ \\begin{array}{ccccc}\n    0.60 & 0.10 & 0.10 & 0.10 & 0.10 \\\\\n    0.20 & 1.70 & 0.30 & 0.20 & 0.20 \\\\\n    0.40 & 0.30 & 0.50 & 0.40 & 0.30 \\\\\n    0.20 & 0.10 & 0.30 & 0.20 & 0.10 \\\\\n    0.10 & 0.10 & 0.10 & 0.10 & 0.10\n               \\end{array} \\right]\n\\]\nwhere the classes are: (1) pre-school age, (2) school age, (3) young adult, (4) mid-adult, (5) old adult.\nG &lt;- matrix( \n  c(0.60,0.10,0.10,0.10,0.10,\n    0.20,1.70,0.30,0.20,0.20,\n    0.40,0.30,0.50,0.40,0.30,\n    0.20,0.10,0.30,0.20,0.10,\n    0.10,0.10,0.10,0.10,0.10), nr=5, nc=5,\n  byrow=TRUE)\n\n(E &lt;- calc.elas(G))\n\n            [,1]        [,2]        [,3]        [,4]         [,5]\n[1,] 0.010155405 0.013880374 0.004378325 0.001901094 0.0012386153\n[2,] 0.011068898 0.771575605 0.042949451 0.012432602 0.0081001829\n[3,] 0.006770904 0.041645019 0.021893672 0.007605088 0.0037161936\n[4,] 0.002477231 0.010157612 0.009612131 0.002782429 0.0009064146\n[5,] 0.001081376 0.008868129 0.002797298 0.001214603 0.0007913475\n\nround(E,2)\n\n     [,1] [,2] [,3] [,4] [,5]\n[1,] 0.01 0.01 0.00 0.00 0.00\n[2,] 0.01 0.77 0.04 0.01 0.01\n[3,] 0.01 0.04 0.02 0.01 0.00\n[4,] 0.00 0.01 0.01 0.00 0.00\n[5,] 0.00 0.01 0.00 0.00 0.00\nWe can see that, overwhelmingly, the most important task should be controlling transmission between school-age children. This should not be that surprising, given the fact that the entry for the G-matrix for within-school-age transmission is more that three times higher than for any other pairwise value. Note that the elasticity for this transmission is over 19 times higher than any other dyad in the population.\nLongini, Ackerman, and Elveback (1978) note that different infections will have different optimal patterns of control and that these depend critically on the age-structure of transmission for the different pathogens."
  },
  {
    "objectID": "R0.html#the-basic-reproduction-number-in-a-nutshell",
    "href": "R0.html#the-basic-reproduction-number-in-a-nutshell",
    "title": "1  That Basic Reproduction Number",
    "section": "1.1 The Basic Reproduction Number in a Nutshell",
    "text": "1.1 The Basic Reproduction Number in a Nutshell\nThe basic reproduction number, \\(R_0\\), is defined as the expected number of secondary cases produced by a single (typical) infection in a completely susceptible population. It is important to note that \\(R_0\\) is a dimensionless number and not a rate, which would have units of \\(\\mathrm{time}^{-1}\\). Some authors incorrectly call \\(R_0\\) the “basic reproductive rate.”\nWe can use the fact that \\(R_0\\) is a dimensionless number to help us in calculating it.\n\\[ R_0 \\propto \\left( \\frac{{\\rm infection}}{{\\rm contact}} \\right) \\cdot\n\\left( \\frac{{\\rm contact}}{{\\rm time}}\\right) \\cdot \\left( \\frac{{\\rm\ntime}}{{\\rm infection}}\\right) \\]\nMore specifically:\n\\[\nR_0 = \\tau \\cdot \\bar{c} \\cdot d\n\\tag{1.1}\\]\nwhere \\(\\tau\\) is the transmissibility (i.e., probability of infection given contact between a susceptible and infected individual), \\(\\bar{c}\\) is the average rate of contact between susceptible and infected individuals, and \\(d\\) is the duration of infectiousness."
  },
  {
    "objectID": "R0.html#the-sir-epidemic-model",
    "href": "R0.html#the-sir-epidemic-model",
    "title": "1  That Basic Reproduction Number",
    "section": "1.2 The SIR Epidemic Model",
    "text": "1.2 The SIR Epidemic Model\nIt is pretty clear how we calculate \\(R_0\\) given information on transmissibility, contact rates, and the expected duration of infection. But how do we know that this quantity defines the epidemic threshold of a particular infection? To understand this, we need to formulate an epidemic model. The model we use is called an SIR model, where SIR stands for “Susceptible-Infected-Removed.”\nFor simplicity, we will deploy several assumptions:\n\nConstant (closed) population size, \\(N\\)\nConstant rates (e.g., transmission, removal rates)\nNo demography (i.e., births and deaths)\nWell-mixed population\n\nA well-mixed population is one where any infected individual has a probability of contacting any susceptible individual that is reasonably well approximated by the average. This is often the most problematic assumption, but is easily relaxed in more complex models.\nIn our closed population of \\(N\\) individuals, say that \\(S\\) are susceptible, \\(I\\) infected, and \\(R\\) are removed. Write \\(s=S/N\\), \\(i=I/N\\), \\(r=R/N\\) to denote the fraction in each compartment.\nThe SIR model is then:\n\\[\n\\begin{aligned}\n  \\frac{ds}{dt} & =  -\\beta si \\\\\n  \\frac{di}{dt} & =  \\beta si - \\nu i \\\\\n  \\frac{dr}{dt} & =   \\nu i\n\\end{aligned}\n\\]\nwhere \\(\\beta = \\tau \\bar{c}\\) and is known as the effective contact rate, \\(\\nu\\) is the removal rate. By assumption all rates are constant. This means that the expected duration of infection is simply the inverse of the removal rate: \\(d = \\nu^{-1}\\).\nWhat are the conditions for an epidemic? An epidemic occurs if the number of infected individuals increases, i.e., \\(di/dt &gt; 0\\)\n\\[ \\beta si - \\nu i &gt; 0 \\]\n\\[ \\frac{\\beta si}{\\nu} &gt; i \\]\nAt the outset of an epidemic, nearly everyone (except the index case) is susceptible. So we can say that \\(s \\approx 1\\). Substituting \\(s=1\\), we arrive at the following inequality\n\\[ \\frac{\\beta}{\\nu} = R_0 &gt; 1 \\]\nSince \\(\\beta = \\tau \\bar{c}\\) and \\(d = \\nu^{-1}\\), we see that we have derived our expression for \\(R_0\\) given in Equation 1.1. This little bit of mathematical trickery explains why we have that cumbersome phrase “in a completely susceptible population” tacked onto our definition for \\(R_0\\).\n\n1.2.1 Heterogeneous Contact\nEpidemiologists who studied gonorrhea infection noted that there was a great deal of behavioral heterogeneity in sexual behavior in populations with endemic infection. Hethcote and Yorke (1984) suggested that partnership heterogeneity might actually permit continued gonorrhea transmission, even when the average population behavior should not support continued infection. Nold (1980) first articulated a mathematical treatment of this phenomenon and R. M. Anderson et al. (1986) derived an analytical relationship for the impact of such behavioral heterogeneity on the basic reproduction number for HIV infection.\nBegin again with a population of \\(N\\) individuals that is divided into \\(k\\) subgroups, \\(N_i\\), where \\(i\\) is the average number of sexual partners per unit time. \\(N_i = N p_i\\), where \\(p_i\\) is the proportion of the population in the \\(i\\)th activity class. We use an SI model, since there is no recovery from HIV infection (at least there wasn’t in 1986).\nAssume (and this is a big assumption) that the risk of transmission increases linearly with the average number of partners. Let \\(\\lambda = \\tau I/N\\) be the force of infection, where \\(\\tau\\) is the probability of transmission given contact. R. M. Anderson et al. (1986) use \\(\\beta\\) for this probability, but this is confusing given more current usage where \\(\\beta\\) is more conventionally the product of transmissibility and the mean rate of contact between susceptibles and infectious individuals. We therefore use \\(\\tau\\) in the derivation rather than \\(\\beta\\). Thus, the rate of formation of new infections in the \\(i\\)th activity class is \\(i \\lambda\\). Let \\(X_i(t)\\) and \\(Y_i(t)\\) be the number of susceptible and infectious individuals in activity class \\(i\\) respectively. Our SI model is thus written as:\n\\[\n\\begin{aligned}\n\\frac{dX_i}{dt} & =  -i \\lambda X_i  \\\\\n\\frac{dY_i}{dt} & =  i \\lambda X_i - \\nu Y_i\n\\end{aligned}\n\\tag{1.2}\\]\nAt time \\(t\\), assuming proportionate mixing (another big assumption) the overall force of infection is:\n\\[\n\\lambda(t) = \\frac{\\tau \\sum_i i Y_i(t)}{\\sum_i i N_i(t)}\n\\tag{1.3}\\]\nIntegrate Equation 1.2 (\\(dX_i/dt\\)) to get\n\\[\nX_i(t) = N_i \\exp \\left[-i \\psi(t) \\right],\n\\tag{1.4}\\]\nwhere \\(\\psi(t)\\) is simply the summed force of infection up to time \\(t\\):\n\\[ \\psi(t) = \\int_0^t \\lambda(g) dg. \\]\nSubstitute Equation 1.3 into Equation 1.2 and sum to produce a differential equation for \\(\\lambda(t)\\):\n\\[\n\\frac{d\\lambda}{dt} = \\lambda \\left( \\tau \\sum_i i^2 e^{-i \\psi}\n  p_i/\\sum_i i p_i - \\nu \\right).\n\\tag{1.5}\\]\nAt the outset of an epidemic, we can assume that approximately everyone in each activity class is susceptible (i.e., \\(X_i \\approx N_i\\)) and the summed force of infection is zero, \\(\\psi = 0\\), since there’s been no epidemic yet! This simplifies Equation 1.5 considerably. Note that, after simplification, the term in the numerator (\\(\\sum_i i^2 p_i\\)) is the expectation of a squared variable, \\(E(i^2)\\). This is related to variance, which by definition is \\(\\operatorname{Var}(i) = E(i - E(i))^2 = E(i^2) - E(i)^2\\). So \\(E(i^2) = E(i) + \\operatorname{Var}(i)\\). The denominator (\\(\\sum_i i p_i\\)) is the expected (or mean) number of contacts \\(E(i)\\). Call the variance in contacts \\(\\sigma^2\\) and the mean number of contacts \\(\\mu\\). Noting that \\(\\beta=\\tau \\mu\\) and defining the coefficient of variation as \\(c = \\sigma/\\mu\\), we get the relationship:\n\\[\n\\frac{d\\lambda}{dt} = \\lambda \\left[ \\beta (1 + c^2) - \\nu \\right].\n\\tag{1.6}\\]\nSolving for \\(\\dot{\\lambda}&gt;0\\), we recover the value of \\(R_0\\) for heterogeneous contacts.\n\\[\nR_0 = \\mathcal{R}_0^{(M)}(1 + c^2),\n\\tag{1.7}\\]\nwhere \\(\\mathcal{R}_0^{(M)}\\) is the mean-field solution for \\(R_0\\)."
  },
  {
    "objectID": "R0.html#epidemic-thresholds-in-structured-populations",
    "href": "R0.html#epidemic-thresholds-in-structured-populations",
    "title": "1  That Basic Reproduction Number",
    "section": "1.3 Epidemic Thresholds in Structured Populations",
    "text": "1.3 Epidemic Thresholds in Structured Populations\n\n1.3.1 Next Generation Matrix: Intuitive Approach\nIf \\(R_0\\) is the number of secondary infections produced by a single typical infection in a rarefied population, how do we define it when there are multiple types of infected individuals. For example, what is a typical infection in a vector-borne disease like malaria? What about a sexually transmitted infection where there are large asymmetries in transmissibility (like HIV)? Or what about a multi-host pathogen like influenza?\nIt turns out that there is a straightforward extension of the theory for structured epidemic models Driessche and Watmough (2002). The mathematics behind this theory is not especially difficult, but it does involve scary German terms that are not familiar to the non-engineers in our midst. The key concept is that we now need to average the expected number of new infections over all possible infected types.\nAssume that we have a system in which there are multiple discrete types of infected individuals (e.g., mosquitoes and humans; women and men; or humans, dogs, and chickens). We define the next generation matrix as the square matrix \\(\\mathbf{G}\\) in which the \\(ij\\)th element of \\(\\mathbf{G}\\), \\(g_{ij}\\), is the expected number of secondary infections of type \\(i\\) caused by a single infected individual of type \\(j\\), again assuming that the population of type \\(i\\) is entirely susceptible. That is, each element of the matrix \\(\\mathbf{G}\\) is a reproduction number, but one where who infects whom is accounted for.\nOnce we have \\(\\mathbf{G}\\), we are one step away from \\(R_0\\). The basic reproduction number is given by the spectral radius of \\(\\mathbf{G}\\). The spectral radius is the also known as the dominant eigenvalue of \\(\\mathbf{G}\\). The next generation matrix has a number of desirable properties from a mathematical standpoint. In particular, it is a non-negative matrix and, as such, it is guaranteed that there will be a single, unique eigenvalue which is positive, real, and strictly greater than all the others. This is \\(R_0\\).\nFor illustrative purposes, we will limit our discussion to the case where there are two classes of infected individual. The next generation matrix is thus \\(2 \\times 2\\). For the \\(2 \\times 2\\) matrix, there is a fairly simple formula for the eigenvalues that everyone who took algebra in high school should know. Define\n\\[       \\mathbf{G} = \\left[ \\begin{array}{cc}\n    a  & b  \\\\\n    c & d\n   \\end{array} \\right]\n\\]\nThe eigenvalues of \\(\\mathbf{G}\\) are:\n\\[ \\lambda_{\\pm} = \\frac{T}{2} \\pm \\sqrt{(T/2)^2 - D} \\]\nwhere \\(T=a+d\\) is the trace and \\(D=ad-bc\\) is the determinant of matrix \\({\\bf G}\\).\nSay you have a sexually transmitted disease in a completely heterosexual population. Define \\(f\\) as the expected number of infected women and \\(m\\) as the expected number of infected men given contact with a single infected member of the opposite sex in a completely susceptible population. The next generation matrix is\n\\[       \\mathbf{G} = \\left[ \\begin{array}{cc}\n    0  & f  \\\\\n    m & 0\n   \\end{array} \\right]\n\\]\n\\(R_0\\) is thus \\(\\sqrt{mf}\\). It is worth noting that this is the geometric mean of the expected number of female and male secondary cases.\nWhen you have more than two discrete types of infectious classes, the formula for calculating the eigenvalues is not as simple, but the same ideas apply. In practice, we typically calculate eigenvalues numerically using software like R.\n\n\n1.3.2 Next Generation Matrix: More Formal Approach\nA review paper by Heffernan, Smith, and Wahl (2005) provides a nice readable introduction for calculating \\(R_0\\) in structured population models. The notation I use here follows their usage.\nConsider the next generation matrix \\(\\mathbf{G}\\). It is comprised of two parts: \\(F\\) and \\(V^{-1}\\), where\n\\[\nF = \\left[ \\frac{\\partial F_i(x_0)}{\\partial x_j} \\right]\n\\tag{1.8}\\]\nand\n\\[\nV = \\left[ \\frac{\\partial V_i(x_0)}{\\partial x_j} \\right]\n\\tag{1.9}\\]\nThese are square matrices of the partial derivatives of new infections (\\(F_i\\)) and transfers between different compartments (\\(V_i\\)). The rank of these matrices is the number of distinct classes of infections. For example, in a simple two-sex SIR model, the next generation matrix would be \\(2 \\times 2\\) since there are two classes of infection (i.e., female and male). \\(x_0\\) is the disease-free equilibrium state. This matrix should be non-negative, irreducible, and primitive.\n\\(R_0\\) is then the dominant eigenvalue of the matrix \\(\\mathbf{G}=FV^{-1}\\).\nExample: SEIR Epidemic Consider a Susceptible-Exposed-Infected-Removed (SEIR) Epidemic. This is an appropriate model for a disease where there is a considerable post-infection incubation period in which the exposed person is not yet infectious.\nadd SEIR state diagram\nThe simple SEIR model consists of a set of four differential equations:\n\\[\n\\begin{aligned}\n\\dot{S} & =  -\\beta S I + \\lambda - \\mu S \\\\\n\\dot{E} & =  \\beta SI - (\\mu + k) E \\\\\n\\dot{I} & =  kE - (\\gamma + \\mu) I \\\\\n\\dot{R} & =  \\gamma I - \\mu R\n\\end{aligned}\n\\]\nwhere \\(\\beta\\) is the effective contact rate, \\(\\lambda\\) is the “birth” rate of susceptibles, \\(\\mu\\) is the mortality rate, \\(k\\) is the progression rate from exposed (latent) to infected, \\(\\gamma\\) is the removal rate.\nNote that in the absence of infection, the equilibrium number of susceptible is \\(S^* = \\lambda/\\mu\\).\nTo calculate the next generation matrix for the SEIR model, we need to enumerate the number of ways that (1) new infections can arise and (2) the number of ways that individuals can move between compartments. There are two disease states but only one way to create new infections. New infections arise through the exposed class. There are only two infection classes \\(E\\) and \\(I\\). Our \\(F\\) matrix collects the partial derivatives of the rate of new infections with respect to changes in the infection classes:\n\\[\nF = \\left(\n          \\begin{array}{cc}\n            0 & \\frac{\\beta  \\lambda }{\\mu } \\\\\n            0 & 0 \\\\\n          \\end{array}\n        \\right),\n         \\tag{1.10}\\]\nwhere we substitute the disease-free equilibrium for \\(S\\).\nThe \\(V\\) matrix collects the partial derivatives of the various ways to move between the two infection states:\n\\[\nV = \\left(\n          \\begin{array}{cc}\n            k+\\mu  & 0 \\\\\n            -k & \\gamma +\\mu  \\\\\n          \\end{array}\n        \\right)\n\\tag{1.11}\\]\n\\(R_0\\) is the leading eigenvalue of the matrix \\(FV^{-1}\\). This is reasonably straightforward to calculate since \\(FV^{-1}\\) is simply a \\(2\\times2\\) matrix.\n\\[\nR_0 = \\frac{k \\beta  \\lambda }{\\mu  (k +\\mu ) (\\gamma +\\mu )}\n\\tag{1.12}\\]\nIt is interesting to note that \\(R_0\\) is also the product of the rate of production of (1) new exposures and (2) new infections, as it should be."
  },
  {
    "objectID": "R0.html#what-is-a-generation",
    "href": "R0.html#what-is-a-generation",
    "title": "1  That Basic Reproduction Number",
    "section": "1.4 What is a Generation?",
    "text": "1.4 What is a Generation?\nIn demography, \\(R_0\\) represents the ratio of total population size from the start to the end of a generation, which is, roughly, the mean age of childbearing. \\(R_0 = e^{rT}\\), where \\(r\\) is the instantaneous rate of increase of the population. So what is a generation in an epidemic model? Generations in epidemic models are the waves of secondary infection that flow from each previous infection. So, the first generation of an epidemic is all the secondary infections that result from infectious contact with the index case, who is of generation zero. If \\(\\mathcal{R}_i\\) denotes the reproduction number of the \\(i\\)th generation, then \\(R_0\\) is simply the number of infections generated by the index case, i.e., generation zero. Now, these numbers are typically small and are therefore susceptible to random sampling error. Consequently, we talk about expected (i.e., averaged over many epidemics) numbers of secondary cases produced by generation zero. See Diekmann and Heesterbeek (2000) or Heesterbeek (2002) for a more complete discussion of this topic.\nFigure~\\(\\ref{fig:gen}\\) shows a schematic representation of an epidemic. The zeroth generation of the epidemic is the index case – patient zero – indicated in red. The number of secondary infections generated by the case in generation zero is \\(R_0=3\\). In the first generation (blue), \\(\\mathcal{R}_1=6/3=2\\). The second generation (cyan) has \\(\\mathcal{R}_1=12/6=2\\).\ninclude generations figure\nThe generation time of an epidemic is typically called the serial interval which we will denote \\(V\\). Roy M. Anderson and May (1991) show how we can use the serial interval to estimate \\(R_0\\) at the outset of an outbreak. Assuming constant mortality, they show that\n\\[\n  R_0 = 1 + r V,\n\\tag{1.13}\\]\nwhere \\(r\\) is the exponential rate of increase of infections. Assuming the outbreak started with a small number of infections (e.g., 1), we estimate this simply as \\(r=\\log(I(t))/t\\).\nFor example, on 26 January 2020, the WHO situation report indicated that there were approximately 2000 COVID-19 cases in China. On the same day, Imperial College epidemiologist Neil Ferguson told the Guardian newspaper that he believed there were already 100,000 infections in China. Based on previous estimates from the 2003 SARS outbreak, the serial interval can be assumed to be 5-7 days. Early epidemic reporting suggest that the spillover event occurred some time around 1 December 2019, meaning that 26 January was 56 days into the epidemic (allowing for a one-day reporting lag). So at a minimum, we can estimate \\(R_0 \\approx 1 + 5 \\times \\log(2000) = 1.68\\). At the other end, we have \\(R_0 \\approx 1 + 7 \\times \\log(100000) = 2.44\\). Note that the shorter serial interval, perhaps counter-intuitively, means that \\(R_0\\) is lower. This is because, for a given epidemic size, the number of infections has taken more generations to get to that size."
  },
  {
    "objectID": "R0.html#doubling-time-of-an-epidemic",
    "href": "R0.html#doubling-time-of-an-epidemic",
    "title": "1  That Basic Reproduction Number",
    "section": "1.5 Doubling Time of an Epidemic",
    "text": "1.5 Doubling Time of an Epidemic\n\\(R_0\\) also gives us information about the doubling time of an epidemic. This is a pretty intuitive statistic that can effectively communicate the potential severity of an outbreak. Denote the doubling time of the epidemic \\(T_D\\), then\n\\[\n  T_D = \\frac{\\log(2) V}{R_0 -1}.\n\\tag{1.14}\\]\nAn outbreak with \\(R_0=2.5\\) and a serial interval of \\(V=5\\) will double every 2.3 days.\nWe can also calculate the doubling time of an ongoing outbreak from case counts on two different days.\n\\[\n  T_D = \\frac{t_1 - t_0}{\\log_2 \\left(\\frac{N_1}{N_0} \\right)}\n\\tag{1.15}\\]\nCDC reports that there were 10 confirmed COVID-19 cases in the USA on 21 February 2020 and 41 nine days later on 1 March. This suggests a doubling time of 4.2 days for confirmed cases. Given the almost complete lack of testing at this point in the epidemic, this is probably quite a bit greater than the actual doubling time of actual infections."
  },
  {
    "objectID": "R0.html#will-an-epidemic-infect-everyone",
    "href": "R0.html#will-an-epidemic-infect-everyone",
    "title": "1  That Basic Reproduction Number",
    "section": "1.6 Will An Epidemic Infect Everyone?",
    "text": "1.6 Will An Epidemic Infect Everyone?\nWill an epidemic, once it has taken off in a population, eventually infect everyone? In order to answer this question, we want to know how \\(i\\) changes with respect to the “fuel” for the epidemic, \\(s\\).\nFrom the SIR formulation, we thus divide equation for \\(di/dt\\) by the equation \\(ds/dt\\).\n\\[ \\frac{di}{ds} =  -1 + \\frac{\\nu}{\\beta s} \\]\nWe solve this equation by first multiplying both sides by \\(ds\\)\n\\[di =  (-1 + \\frac{\\nu}{\\beta s})ds \\]\nWe then integrate and do a little algebra, yielding\n\\[\n  \\log(s_{\\infty}) =  R_0 (s_{\\infty}-1)\n\\tag{1.16}\\]\nThis is an implicit equation for \\(s_{\\infty}\\), the number of susceptibles at the end of the epidemic. When \\(R_0 &gt; 1\\), this equation has exactly two roots, only one of which lies in the interval \\((0,1)\\). %Subtract \\(\\log(s_{\\infty})\\) from both sides and we get \\(R_0 (s\\_{\\infty}-1)-\\log(s\\_{\\infty})=0\\). Call the whole left-hand side \\(y\\). \\(y\\) will have different values for different values of \\(\\log(s_{\\infty})\\). Only a couple of those will satisfy Equation 1.16. \\(\\log(s_{\\infty})=0\\) (i.e., everyone remains susceptible since there is no epidemic) will always satisfy Equation 1.16 (plug it in and see!). When \\(R_0&gt;1\\), the other solution is the actual value of the final size. This is the one we really care about. If \\(R_0 \\leq 1\\), the only value that satisfies Equation 1.16 is \\(s_{\\infty}=1\\). In words, at the end of the epidemic, everyone will still be susceptible (i.e., no one gets infected).\n\n## geometry of final-size equation\ncurve(log(x), c(0,1), type=\"l\", lwd=2, xaxs=\"i\", xlab=\"Fraction Susceptible\", ylab=\"y\")\ncurve(2*(x-1), c(0,1), add=TRUE)\ncurve(2.5*(x-1), c(0,1), add=TRUE)\ncurve(3*(x-1), c(0,1), add=TRUE)\ncurve(0.9*(x-1), c(0,1), col=\"red\",add=TRUE)\n\n\n\n\nThis shows a geometric interpretation of Equation 1.16 for various values of \\(R_0 &gt; 1\\) in black. The point where the line \\(R_0 (s_{\\infty}-1)\\) is tangent to the curve \\(\\log(s_{\\infty})\\) indicates the value of \\(s_{\\infty}\\) for a given \\(R_0\\). As \\(R_0\\) gets larger, the final size of the epidemic gets larger as well (i.e., the fraction susceptible at the end of the epidemic gets smaller). Figure~\\(\\ref{fig:final-size}\\) also shows the solution when \\(R_0 = 1\\) in red. The only tangent to the curve \\(y=\\log(s_{\\infty})\\) occurs at \\(s_{\\infty}=1\\), meaning that essentially none of the total population becomes infected when an infection is sub-critical.\n\n## final-size curve\n\nfs &lt;- function(ro,s) ro*(s-1) - log(s)\n## s=1 always a solution; want interior one\n\nfinal.size &lt;- function(ro){\n  return(1-uniroot(fs,c(0,0.99), ro=ro)$root)\n}\n## will give an error if R0=1\n\n## redo plot\nRR &lt;- seq(1.01,6, length=500)\nff &lt;- rep(NA,500)\nfor(i in 1:500) ff[i] &lt;- final.size(RR[i])\n\n## Polygons to indicate range of possible final sizes\n\n# vertical\nrrange &lt;- c(RR[80],RR[80:200],RR[200])\nfsrange &lt;- c(0,ff[80:200],0)\n# horizontal\nfsrange1 &lt;- c(ff[80],ff[80:200],ff[200])\nrrange1 &lt;- c(0.9,RR[80:200],0.9)\n\nplot(c(1,RR), c(0,ff), type=\"n\", \n     xaxs=\"i\", yaxs=\"i\", xlim=c(0.95,6.05), ylim=c(0,1.1),\n     xlab=expression(R[0]), ylab=\"Final Size\")\npolygon(rrange,fsrange,col=rgb(255,0,0, 60, maxColorValue = 255),\n        border=NA)\npolygon(rrange1,fsrange1,col=rgb(255,0,0, 60, maxColorValue = 255),\n                                 border=NA)\nlines(c(1,RR), c(0,ff), lwd=3, col=\"blue4\")\n\n\n\n\nThis figure plots the final size (\\(1-s_{\\infty}\\)) for values of \\(R_0\\) ranging from 1-6. We can see that the curve is highly concave and approaches value of the whole population very slowly. We note the final size for \\(R_0=2.5\\), which is approximately the consensus estimate for the ongoing COVID-19 epidemic. The fraction remaining susceptible at the end of the epidemic is \\(s_{\\infty}=0.107\\), so 89.3% of the population will ultimately become infected (assuming nothing changes).\nThe conclusion we can draw from all this analysis is that, in general, a fraction of the population will escape infection. That is, \\(s_{\\infty} &gt; 0\\). This is one of the fundamental insights of mathematical theory of epidemics. It is very important to remember that final-size calculation assume that nothing changes in the epidemic. Public-health interventions (e.g., social distancing, quarantine, vaccination) and medical interventions (e.g., curing sick people) will reduce the effective reproduction number (i.e., the expected number of secondary cases produced by a case at some point later in the epidemic). This is indeed the goal of epidemic control!\n\n1.6.1 The Critical Vaccination Threshold and Herd Immunity\nVaccines have both medical and public health utility. The medical utility is that a successfully-vaccinated person is protected from acquiring the disease against which she is vaccinated. The public health utility is that when a sufficiently large share of the population is vaccinated, the potential force of infection falls below the critical threshold for an outbreak. When this happens, the population is said to experience “herd immunity” (Fine 1993).\nFor an SIR-type epidemic in a well-mixed population, it is trivial to calculate the critical vaccination threshold. The key is to bring the reproduction number below its critical value, i.e., make \\(R_0 &lt; 1\\). Let \\(R\\) be the reproduction number of the immunized population and let \\(0 \\leq p \\leq 1\\) be the fraction of the population successfully vaccinated. Clearly,\n\\[ R \\leq R_0(1-p). \\]\nSimply solve for \\(R&lt;1\\), letting \\(p_c\\) denote the critical vaccination fraction:\n\\[\n  p_c = 1 - \\frac{1}{R_0}.\n\\tag{1.17}\\]\n\n1.6.1.1 The Effect of Heterogeneity\nEquation 1.17 only applies to well-mixed populations with a single type of infected agent. Heterogeneity changes this. Natural selection arises from the differential fitness of alternate phenotypes. Individuals bearing phenotypes that make them better-suited for their current environments differentially survive and reproduce successfully compared to individuals bearing less well-adapted phenotypes for the environment. Another way of conceptualizing the action of natural selection is due to one of the architects of the New Evolutionary Synthesis, Ernst Mayr, who characterized the action of natural selection as non-random elimination. In this conceptualization, individuals with the least-well-suited phenotypes are eliminated from the population (Mayr 1997) and those remaining do the reproduction. It turns out that this process of non-random elimination, albeit without the reproduction, is common in all sorts of heterogeneous populations. Cohort selection occurs when individuals differentially exit a population based on some (often hidden) phenotype. The hidden heterogeneity that causes differential exit from the population is typically known as frailty. Frailty can have profound impacts on epidemics.\nFerrari et al. (2006) provide an important theoretical discussion of the effects of network frailty on the persistence of epidemics. They note that the behaviorally-heterogenous populations subject to the transmission of an infectious disease can be represented as networks or graphs with a heterogeneous degree distribution. The degree of a vertex in a graph is simply the number of edges that are incident to it, and the degree distribution is just aggregate of the degree of all of a given network’s vertices (essentially, a histogram of degree). In the early phases of an epidemic, individuals who are connected to many others (i.e., have high degree) are more likely to be infected than those with fewer contacts. This means that most-connected individuals are likely to be removed early in an epidemic, either through death or acquired immunity. As the most-connected vertices are differentially removed from the network, the previously strongly-connected network may break apart or otherwise become more sparse, making it easier for the epidemic to fade out (since the effective reproduction number, \\(R_i\\), will decrease because of markedly lower contact rates). This effect is illustrated in the following two figures. The effect of this frailty is that effective herd immunity may occur at a much lower prevalence than predicted by Equation 1.17.\n\n\n\nA heterogeneous network with a high-degree vertex highlighted. Because of its many contacts, this vertex is at risk of infection early in the epidemic.\n\n\n\n\n\nThe graph becomes substantially more sparse with the five most highly-active vertices removed from it. If we continued to remove vertices with high degree, the previously connected graph would become disconnected and an epidemic would no longer be possible.\n\n\nNetwork frailty may have been the culprit underlying the famous failure of three high-profile randomized, controlled trials of STD treatment and behavior change interventions to reduce HIV incidence in the East African cities of Mwanza, Tanzania and Rakai and Masaka, Uganda (Orroth et al. 2003).\nIt is also possible that the effective herd-immunity threshold will be higher than \\(p_c\\) predicted by Equation 1.17. Salathé and Bonhoeffer (2008) show that when people with similar susceptibilities differentially cluster (a phenomenon known as homophily), the critical herd-immunity threshold can be substantially higher than predicted by Equation 1.17. This turns out to be extremely important for the COVID-19 pandemic experience in the United States (Smaldino and Jones 2021)."
  },
  {
    "objectID": "R0.html#changing-r_0",
    "href": "R0.html#changing-r_0",
    "title": "1  That Basic Reproduction Number",
    "section": "1.7 Changing \\(R_0\\)",
    "text": "1.7 Changing \\(R_0\\)\nFor a given small change in the environment, broadly construed, the change in \\(R_0\\) will be:\n\\[\n\\frac{d R_0}{d \\epsilon} = \\frac{d \\tau}{d \\epsilon}\\, \\frac{d\n  R_0}{d\\tau} + \\frac{d\\bar{c}}{d\\epsilon}\\, \\frac{dR_0}{d\\bar{c}} +\n\\frac{d\\delta}{d\\epsilon}\\, \\frac{dR_0}{d\\delta}\n\\tag{1.18}\\]\nFor example, one could imagine an increase in temperature having two distinct effects. On the one hand, increased temperature could increase the transmissibility of a pathogen by increasing its replication rate. However, it could also\ndecrease the contact rate between hosts because of behavioral modulation to avoid heat stress on the part of the hosts. Whether \\(R_0\\) increases or decreases depends on the particulars of the system. The devil is always in the details in complex systems. If we are to make a sound case for connections between environmental change and EID, we need to be measured and rigorous.\n\n1.7.1 The Fastest Way to Reduce \\(R_0\\)\nWe want to bring the effective reproduction number \\(R_0\\) below one in a multi-host epidemic. Clearly, reducing the number of infections in any cell in the next-generation matrix will reduce \\(R_0\\), but which will provide the greatest reduction for a given effort? To figure this out, we calculate the sensitivities of \\(R_0\\) to a change in the various entries of the next-generation matrix. These are the partial derivatives (i.e., the rate of change in \\(R_0\\) with respect to gij holding everything else constant).\n\\[ s_{ij} = \\frac{\\partial R_0}{\\partial g_{ij}} \\]\n\ncalc.sens &lt;- function(G){\n  ev &lt;- eigen(G)\n  lmax &lt;- which(Re(ev$values)==max(Re(ev$values)))\n  U &lt;- ev$vectors\n  u &lt;- abs(Re(U[,lmax]))\n  V &lt;- solve(Conj(U))\n  v &lt;- abs(Re(V[lmax,]))\n  \n  s &lt;- v%o%u\n  return(s)\n}"
  },
  {
    "objectID": "R0.html#chagas-disease-example",
    "href": "R0.html#chagas-disease-example",
    "title": "1  That Basic Reproduction Number",
    "section": "1.8 Chagas Disease Example",
    "text": "1.8 Chagas Disease Example\nConsider a three-species model introduced by Cohen and Gürtler (2001). The three species included in this household-based model are humans, triatomine bugs, and dogs. Define \\(\\mathbf{G}\\):\n\\[ \\mathbf{G} = \\left[ \\begin{array}{ccc}\n            0 & g_{B \\leftarrow D} & g_{B \\leftarrow H} \\\\\n            g_{D \\leftarrow B} & 0 & 0 \\\\\n            g_{H \\leftarrow B}  & 0 & 0\n            \\end{array} \\right],\n\\]\nwhere (e.g.) \\(g_{B \\leftarrow D}\\) is the dog-infecting-bug reproduction number.\nCohen and Gürtler (2001) give some data that allow us to estimate the next generation matrix. We fill in the missing parameters with educated guesses (more on this later) and calculate the sensitivities.\n\nG &lt;- matrix( c(0,122.01,7.47, 0.1992,0,0, 0.1992,0,0), nr=3, nc=3, byrow=TRUE)\n# first, what is R_0?\neigen(G)$values\n\n[1] -5.078623  5.078623  0.000000\n\n(S &lt;- calc.sens(G))\n\n           [,1]       [,2]       [,3]\n[1,]  0.5000000 0.01961161 0.01961161\n[2,] 12.0121133 0.47115385 0.47115385\n[3,]  0.7354355 0.02884615 0.02884615\n\n\nWe can see that \\(R_0 = 5.08\\) and that, by far, the element of \\(\\mathbf{G}\\) with the highest sensitivity is the bug-to-dog entry. Note that the ordering of the eigenvalues in the output actually lists the negative one first. This is why can’t just take the first eigenvalue but need the line in the code to find the dominant eigenvalue (i.e., the one that is positive, real, and strictly greater than all the others)."
  },
  {
    "objectID": "R0.html#simple-model-for-disease-with-high--and-low-risk-subpopulations",
    "href": "R0.html#simple-model-for-disease-with-high--and-low-risk-subpopulations",
    "title": "1  That Basic Reproduction Number",
    "section": "3.1 Simple Model for Disease with High- and Low-Risk Subpopulations",
    "text": "3.1 Simple Model for Disease with High- and Low-Risk Subpopulations\nAs we saw in Section 4.1, reducing contacts with the low-risk/high-activity subpopulation is the most effective way to flatten the epidemic curve.\n\n# utility function\nmake2x2 &lt;- function(a,b,c,d) matrix( c(a,b,c,d), nr=2, nc=2, byrow=TRUE)\n# beta matrix: (0.5,, 0.15, 0.05, 0.5)\n# population structure is 2/3 low-risk, 1/3 high-risk\n# everyone recovers at rate 1/5\n(G &lt;- make2x2(0.5*.67, 0.15*0.33, 0.05*0.67, 0.5*0.33)*5)\n\n       [,1]   [,2]\n[1,] 1.6750 0.2475\n[2,] 0.1675 0.8250\n\n(E &lt;- calc.elas(G))\n\n          [,1]       [,2]\n[1,] 0.9253696 0.02555400\n[2,] 0.0255540 0.02352238\n\n\nWe see that, overwhelmingly, the best epidemic-reduction bang for our public-health buck comes from reducing the contacts within the low-risk population. This means social distancing.\nA generalization that emerges from applying this sort of analysis to a range of systems is that the most efficient method for epidemic control is to reduce the number of infections in the the subpopulation that has the most infections. This makes sense: you want to reduce the largest source of potential infections in the population. Examples include:\n\nReducing transmission among the high-risk segment (e.g., sex workers, injection-drug users), often known as “the core,” for sexually-transmitted infections like gonorrhea (Hethcote and Yorke 1984).\nReducing transmission among school-age children for influenza\nReducing transmission among domestic fowl in bird-flu\nReducing transmission from triatomine bugs to peri-domestic dogs in Chagas disease\nReducing transmission within the low-risk/high-activity subpopulation in a simple model of COVID-19 dynamics"
  },
  {
    "objectID": "R0.html#sec-virulence",
    "href": "R0.html#sec-virulence",
    "title": "1  That Basic Reproduction Number",
    "section": "3.2 Optimal Virulence: Pathogen Life History Evolution",
    "text": "3.2 Optimal Virulence: Pathogen Life History Evolution\nBut enough about you, let’s talk about me for a while. It’s instructive to think about epidemics from the pathogen’s perspective. Pathogens bear biological information in their nucleic acids. This information varies from one copy of a pathogen to another, and the ability of a pathogen to persist and multiply can be a function of this variability. We therefore have fulfilled the necessary and sufficient conditions for natural selection. Pathogens evolve.\nWe will consider a model in which transmissibility and disease-induced mortality trade-off introduced by Baalen and Sabelis (1995). This interaction is mediated by virulence, which we will take to be proportional to parasite burden or parasitemia. More copies of a virus (say) means that conditional on contact with an infected individual, the pathogen is more likely to be transmitted. However, more viral copies means the host is sicker – and potentially dead. Dead hosts do not transmit and very sick hosts are less likely to be up and interacting with susceptibles.\nConsider a directly-transmitted infection from which there is no recovery (e.g., Herpes Simplex Virus). The population experiences a baseline mortality rate, \\(\\mu\\), and a disease-induced mortality \\(\\delta\\).\n\\[\n\\begin{aligned}\n  ds/dt & =  -\\beta si - \\mu s \\\\\n  di/dt & =  \\beta si - (\\mu + \\delta) i,\n\\end{aligned}\n\\]\nIt is straightforward to show that the basic reproduction number is given by:\n\\[\nR_0 = \\frac{\\beta}{\\mu+\\delta} &gt; 1,\n\\tag{3.1}\\]\nThe parameter \\(\\mu\\) is independent of the epidemic, but the parameters, \\(\\beta\\) and \\(\\delta\\) can conceivably be functions of virulence, which we denote by \\(x\\).\nAn Evolutionary Stable Strategy (ESS) is a phenotype that can not be invaded by a rare mutant. Loosely speaking, it represents the optimal phenotype. The ESS virulence occurs where \\(dR_0/dx = 0\\).\nDifferentiate Equation 3.1 with respect to \\(x\\) using the quotient rule:\n\\[ \\frac{dR_0}{dx} = \\frac{\\beta'(\\mu + \\delta) - \\delta' \\beta}{(\\mu +\n  \\delta)^2} = 0 \\]\nRearranging and evaluating \\(\\beta(x)\\) and \\(\\delta(x)\\) at the ESS values of \\(x\\) (denoted \\(x^*\\)), we have:\n\\[\n\\frac{d\\beta(x)}{d\\delta(x)} = \\frac{\\beta(x^*)}{\\mu+\\delta(x^*)}\n\\tag{3.2}\\]\nThis result has a nice geometric interpretation. The ESS virulence occurs where a line rooted at the origin is tangent to the curve that relates \\(\\beta\\) to \\(\\delta\\). This result is known as the Marginal Value Theorem and has applications in economics and ecology as well as epidemiology. The MVT model for optimal virulence is plotted in Equation 3.2. In the lower curve, the tangent line hits further out on the horizontal axis and mortality is higher.\n\nx &lt;- seq(0,30,length=500)\n# utility function fp&gt; 0 fpp &lt; 0\n# turns out that RMarkdown does not handle comments with single quotes \n# fp == deriv of f; fpp == 2nd deriv of f\nf &lt;- function(x) {\n  0.5 - exp(-0.2*(x-7))\n}\n# derivative of the utility function\nfprime &lt;- function(x) {\n  0.2*exp(-0.2*(x-7))\n}\n\n# f + fp*(z-x) = 0\n# z = x -(f/fp)\n# solve for tangency; find the root of this\nxinter &lt;- function(x) {\n  return(x - f(x)/fprime(x))\n}\n\nsoln &lt;- uniroot(xinter,c(0,40))\n\nplot(x,f(x), type=\"l\", lwd=2, xaxs=\"i\", yaxs=\"i\",\n     axes=FALSE,\n     xlab=\"Mortality\",\n     ylab=\"Transmissibility\",\n     ylim=c(0,0.7))\naxis(1,labels=FALSE,tick=FALSE)\naxis(2,labels=FALSE,tick=FALSE)\nbox()\nlines(x,(f(soln$root)/soln$root)*x,col=\"red\")\nsegments(soln$root,0,soln$root,f(soln$root), lty=2, col=\"red\")\nsegments(0,f(soln$root),soln$root,f(soln$root), lty=2, col=\"red\")\nmtext(expression(paste(delta,\"*\")),1,at=soln$root, padj=1)\nmtext(expression(paste(beta,\"*\")),2,at=f(soln$root),padj=0.5, adj=1.5, las=2)\nmtext(expression(mu),1,at=5, padj=1)\n\n\n\n\nFrank (1996) has a very thorough review of models of the evolution of virulence."
  },
  {
    "objectID": "R0.html#the-sir-model",
    "href": "R0.html#the-sir-model",
    "title": "1  That Basic Reproduction Number",
    "section": "3.3 The SIR Model",
    "text": "3.3 The SIR Model\n\nrequire(deSolve)\n\n## define model equations\nsir &lt;- function(t,x,parms){\n  S &lt;- x[1]\n  I &lt;- x[2]\n  R &lt;- x[3]\n  with(as.list(parms),\n       {\n         dS &lt;- -beta*S*I\n         dI &lt;- beta*S*I - nu*I\n         dR &lt;- nu*I\n         res &lt;- c(dS,dI,dR)\n         list(res)\n       })\n}\n\n## integrate\nN &lt;- 1e4\nparms &lt;- c(N=N,beta=0.0001, nu = 1/2.5)\ntimes &lt;- seq(0,50,0.1)\nx0 &lt;- c(N-1,1,0)\nstateMatrix &lt;- as.data.frame(lsoda(x0,times,sir,parms))\n\n\n## plot\ncolnames(stateMatrix) &lt;- c(\"time\",\"S\",\"I\",\"R\")\nplot(stateMatrix[,\"time\"], stateMatrix[,\"S\"], type=\"l\", lwd=2, col=\"blue\",\n     xlab=\"Time\", ylab=\"Population Size\")\nlines(stateMatrix[,\"time\"], stateMatrix[,\"I\"], col=\"red\", lwd=2)\nlines(stateMatrix[,\"time\"], stateMatrix[,\"R\"], col=\"green\", lwd=2)\nlegend(\"right\", c(\"S\",\"I\",\"R\"), col=c(\"blue\",\"red\",\"green\"), lwd=2)\n\n\n\n\nAn epidemic means infections are increasing. We can look at just the take-off, where \\(dI/dt &gt; 0\\)\n\n## Just show the take-off\nplot(stateMatrix[,\"time\"], stateMatrix[,\"I\"], type=\"l\", lwd=3, col=\"magenta\",\n     xlab=\"Time\",\n     ylab=\"New Infections\",\n     xlim=c(0,15))"
  },
  {
    "objectID": "R0.html#are-you-actually-infected",
    "href": "R0.html#are-you-actually-infected",
    "title": "1  That Basic Reproduction Number",
    "section": "3.4 Are You Actually Infected?",
    "text": "3.4 Are You Actually Infected?\nSuppose you take a COVID-19 rapid test such as a Binax Antigen Self Test. You get back a positive result, indicating that the test was found evidence for SARS-CoV-2 antigens. Do you have COVID-19? We can calculate this probability using Bayes’ Theorem, the rule for updating beliefs in light of new data. The answer may surprise you.\nLet’s start with a few definitions. Let \\(I\\) indicate the presence of infection and \\(\\sim I\\) indicate no infection. The probability of a positive test, given infection is \\(P(P|I)\\). This probability is known as the true positive rate or the sensitivity of the test. The probability of a positive test given no infection is \\(P(P|\\sim I)\\). This is the false positive rate, which is the complement of the specificity of the test (i.e., \\(=1 - \\textrm{specificity}\\)). Finally, let \\(P(I)\\) be the probability of infection or the prevalence of infection. In a surveillance setting, we often estimate prevalence using the positivity rate for surveillance testing.\nBayes’ Theorem tells us that the probability of infection, given a positive test is proportional to the sensitivity of the test times the prevalence. If we want to turn this proportionality into a true probability, we need to normalize by the probability of a positive test. In the case of a diagnostic test like this, there are two mutually-exclusive ways that you can get a positive test: it can be a true positive or a false positive. We put this all together and get the following:\n\\[\nP(I|P) = \\frac{P(P|I)P(I)}{P(P)} = \\frac{P(P|I)P(I)}{P(P|I)P(D) + P(P|\\sim I)P(\\sim I)}\n\\]\nUsing the epidemiological terms:\n\\[\nP(\\textrm{Infection}|\\textrm{Positive Test}) = \\frac{\\textrm{Sensitivity} \\cdot \\textrm{Prevalence}}{\\textrm{Sensitivity} \\cdot \\textrm{Prevalence}\\; +\\; (1 - \\textrm{Specificity}) \\cdot (1 - \\textrm{Prevalence})}\n\\]\nA 2020 study by Prince-Guerra and colleagues in MMWR found that the BinaxNow rapid test had a sensitivity of 64.2% and a specificity of nearly 100%. Since it’s not exactly perfectly specific (and certainty has a disproportionate impact on Bayesian calculations), call the specificity 99%. We can write a simple function to calculate the positive predictive value. Suppose that we have a local positivity rate (i.e., prevalence) of 5%.\n\nppv &lt;- function(sens,spec,prev) {\n                sens*prev/(sens*prev + (1-spec)*(1-prev))\n}\nsens &lt;- 0.642\nspec &lt;- 0.99\nppv(sens,spec,0.05)\n\n[1] 0.7716346\n\n\nThat actually seems pretty solid. A positive Binax test indicates a 77% chance of infection, given a local prevalence of 5%, even though the sensitivity of the test is pretty low. We get this high probability of infection from such a low-sensitivity test because the specificity is so high. Suppose the specificity was only 95%. Using the same values for sensitivity and prevalence, this would cause our PPV to drop to 0.4032663. A small absolute change in specificity leads to a huge change in the the PPV.\n\nprev &lt;- seq(0,0.2,,100)\nplot(prev,ppv(sens=sens,spec=spec,prev=prev), type=\"l\", lwd=2,\n     xlab=\"Prevalence\", ylab=\"PPV\")\n\n\n\n\nWe can also visualize the effect of decreasing specificity on the PPV. According the the Johns Hopkins Coronavirus Resource Center, on 24 December 2021, the state of Florida reported an 11% positivity rate for COVID-19 tests, while the state of California reported a 4% positivity rate.\n\nspec &lt;- seq(1,0.8,,100)\nplot(spec,ppv(sens=sens,spec=spec,prev=0.11), type=\"l\", lwd=2,\n     ylim=c(0,1), xlab=\"Specificity\", ylab=\"PPV\")\nlines(spec, ppv(sens=sens,spec=spec,prev=0.04), lwd=2, col=\"orange\")\ntitle(\"Effects of Specificity on PPV in High- and Low-Prevalence Settings\")\nlegend(\"topleft\",c(\"CA\",\"FL\"), lwd=2, col=c(\"black\",\"orange\"))\n\n\n\n\n\n\n\n\nAnderson, R. M., G. F. Medley, R. M. May, and A. M. Johnson. 1986. “A Preliminary Study of the Transmission Dynamics of the Human Immunodeficiency Virus (HIV), the Causative Agent of AIDS.” IMA Journal of Mathematics Applied in Medicine and Biology 3: 229–63. https://doi.org/10.1093/imammb/3.4.229.\n\n\nAnderson, Roy M., and Robert M. May. 1991. Infectious Diseases of Humans: Dynamics and Control. Oxford: Oxford University Press.\n\n\nBaalen, M. van, and M. W. Sabelis. 1995. “The Dynamics of Multiple Infection and the Evolution of Virulence.” American Naturalist 146 (6): 881–910. http://www.jstor.org/stable/2463102.\n\n\nCohen, J. E., and R. E. Gürtler. 2001. “Modeling Household Transmission of American Trypanosomiasis.” Science 293: 694–98. https://doi.org/10.1126/science.1060638.\n\n\nDiekmann, O., and H. Heesterbeek. 2000. Mathematical Epidemiology of Infectious Diseases: Model Building, Analysis and Interpretation. New York: Wiley.\n\n\nDiekmann, O., J. A. P. Heesterbeek, and J. A. J. Metz. 1990. “On the Definition and the Computation of the Basic Reproduction Ratio \\(R_0\\) in Models for Infectious Diseases in Heterogeneous Populations.” Journal of Mathematical Biology 28 (4): 365–82. https://doi.org/10.1007/BF00178324.\n\n\nDriessche, P. van den, and James Watmough. 2002. “Reproduction Numbers and Sub-Threshold Endemic Equilibria for Compartmental Models of Disease Transmission.” Mathematical Biosciences 180 (1): 29–48. https://doi.org/10.1016/S0025-5564(02)00108-6.\n\n\nFerrari, M. J., S. Bansal, L. A. Meyers, and O. N. Bjornstad. 2006. “Network Frailty and the Geometry of Herd Immunity.” Proceedings of the Royal Society B-Biological Sciences 273 (1602): 2743–48. https://doi.org/10.1098/rspb.2006.3636.\n\n\nFine, Paul E. M. 1993. “Herd Immunity: History, Theory, Practice.” Epidemiologic Reviews 15 (2): 265–302. https://doi.org/10.1093/oxfordjournals.epirev.a036121.\n\n\nFrank, S. A. 1996. “Models of Parasite Virulence.” Quarterly Review of Biology 71 (1): 37–78. https://doi.org/10.1086/419267.\n\n\nGroenendael, Jan van, Hans de Kroon, Susan Kalisz, and Shripad Tuljapurkar. 1994. “Loop Analysis: Evaluating Life History Pathways in Population Projection Matrices.” Ecology 75 (8): 2410–15. https://doi.org/10.2307/1940894.\n\n\nHeesterbeek, J. A. P. 2002. “A Brief History of \\(R_0\\) and a Recipe for Its Calculation.” Acta Biotheoretica 50 (3): 189–204. https://doi.org/10.1023/A:1016599411804.\n\n\nHeffernan, J. M., R. J. Smith, and L. M. Wahl. 2005. “Perspectives on the Basic Reproduction Ratio.” Journal of the Royal Society Interface 2: 281–93. https://doi.org/10.1098/rsif.2005.0042.\n\n\nHethcote, H. W., and J. A. Yorke. 1984. Gonorrhea: Transmission Dynamics and Control. Vol. 56. Lecture Notes in Biomathematics.\n\n\nHill, A. N., and I. M. Longini. 2003. “The Critical Vaccination Fraction for Heterogeneous Epidemic Models.” Mathematical Biosciences 181 (1): 85–106. https://doi.org/10.1016/S0025-5564(02)00129-3.\n\n\nKucharski, Adam J., Kin O. Kwok, Vivian W. I. Wei, Benjamin J. Cowling, Jonathan M. Read, Justin Lessler, Derek A. Cummings, and Steven Riley. 2014. “The Contribution of Social Behaviour to the Transmission of Influenza A in a Human Population.” PLOS Pathogens 10 (6): e1004206. https://doi.org/10.1371/journal.ppat.1004206.\n\n\nLongini, Ira M., Eugene Ackerman, and Lila R. Elveback. 1978. “An Optimization Model for Influenza A Epidemics.” Mathematical Biosciences 38 (1): 141–57. https://doi.org/10.1016/0025-5564(78)90023-8.\n\n\nMayr, Ernst. 1997. “The Objects of Selection.” Proceedings of the National Academy of Sciences 94 (6): 2091–94. https://doi.org/10.1073/pnas.94.6.2091.\n\n\nNold, Annett. 1980. “Heterogeneity in Disease-Transmission Modeling.” Mathematical Biosciences 52 (3): 227–40. https://doi.org/10.1016/0025-5564(80)90069-3.\n\n\nOrroth, Kate K, Eline L Korenromp, Richard G White, Awene Gavyole, Ron H Gray, Lawrence Muhangi, Nelson K Sewankambo, et al. 2003. “Higher Risk Behaviour and Rates of Sexually Transmitted Diseases in Mwanza Compared to Uganda May Help Explain HIV Prevention Trial Outcomes.” AIDS 17 (18): 2653–60. https://doi.org/10.1097/00002030-200312050-00013 .\n\n\nSalathé, Marcel, and Sebastian Bonhoeffer. 2008. “The Effect of Opinion Clustering on Disease Outbreaks.” Journal of the Royal Society Interface 5 (29): 1505–8. https://doi.org/10.1098/rsif.2008.0271.\n\n\nSmaldino, Paul E., and James Holland Jones. 2021. “Coupled Dynamics of Behaviour and Disease Contagion Among Antagonistic Groups.” Evolutionary Human Sciences 3: e28. https://doi.org/10.1017/ehs.2021.22."
  },
  {
    "objectID": "ecology.html#lotka-volterra",
    "href": "ecology.html#lotka-volterra",
    "title": "2  Ecology",
    "section": "2.1 Lotka-Volterra",
    "text": "2.1 Lotka-Volterra\n\nrequire(deSolve)\n## classic Lotka Volterra\nlv &lt;- function(t, x, parms) {\n  with(as.list(parms), {\n    dx1 &lt;- r1*x[1] - c1*x[1]*x[2]\n    dx2 &lt;- -r2*x[2] + c2*x[1]*x[2]\n    results &lt;- c(dx1,dx2)\n    list(results)\n  })\n}\n\nxstart &lt;- c(x1=10,x2=1)\ntimes &lt;- seq(0,300,length=1001)\nparms &lt;- c(r1=0.2, r2=0.1, c1=0.2, c2=0.05)\nout1 &lt;- as.data.frame(ode(xstart,times,lv,parms))\ncolnames(out1) &lt;- c(\"times\",\"prey\",\"predator\")\n\nplot(out1[,\"times\"], out1[,\"prey\"], type=\"l\", lwd=2, col=\"blue\", \n     xlab=\"Time\", ylab=\"Population Size\")\nlines(out1[,\"times\"], out1[,\"predator\"], lwd=2, col=\"red\")\n\n\n\nplot(out1[,\"prey\"], out1[,\"predator\"], type=\"l\", lwd=2, col=\"magenta\", \n     xlab=\"Prey Population Size\", ylab=\"Predator Population Size\")"
  },
  {
    "objectID": "ecology.html#sec-chaos",
    "href": "ecology.html#sec-chaos",
    "title": "2  Ecology",
    "section": "2.2 Surprisingly Complex Dynamics from Simple Models",
    "text": "2.2 Surprisingly Complex Dynamics from Simple Models\nRecreate the plots from May (1976).\n\n# re-create figures in May (1976)\n\n# logistic map\nlmap &lt;- expression(a*x*(1-x))\n\n## make x bound on [0,1] to avoid pathological behavior of negative pop size\nx &lt;- seq(0,1,length=1000)\n\n### first plot the unstable recruitment curve\na &lt;- 3.414\nx1 &lt;- eval(lmap)\nplot(x,x1, type=\"l\", lwd=2,\n     xlab=expression(X[t]),ylab=expression(X[t+1]))\n\n## equilibrium for logistic map\nxstar1 &lt;- 1-(1/a)\n\n## numerical derivative\nx1p &lt;- diff(x1)\nxp &lt;- diff(x)\n### the equilibrium x is approximately x[706]\nm1 &lt;- x1p[706]/xp[706]\n\n### use point-slope eq for a line y - y_1 = m(x - x_1)\n### we know the point (xstar,xstar) so solve for eq we can use to draw line\nlines(x[550:850], m1*x[550:850]-m1*xstar1+xstar1,lty=2)\n\n### now plot the stable recruitment curve\n## lower growth rate means shallower slope at equilibrium\na &lt;- 2.707\nx2 &lt;- eval(lmap)\nlines(x,x2, lwd=2, col=grey(0.75))\nxstar2 &lt;- 1-(1/a)\nx2p &lt;- diff(x2)\nxp &lt;- diff(x)\n### the equilibrium x is approximately x[700]\nm2 &lt;- x2p[630]/xp[630]\nlines(x[480:780], m2*x[480:780]-m2*xstar2+xstar2,lty=2)\nabline(a=0,b=1)\n\n## equilibrium where X_{t+1} = X_t\nlines(x,x)\n\n\n\n\nThe figures are clearly mislabeled in May (1976)\n\n## corrected figure 2\nlmap2 &lt;- expression(a*(a*x*(1-x))*(1-(a*x*(1-x))))\n\n\nx2 &lt;- eval(lmap2)\nplot(x,x2,type=\"l\",xlab=expression(X[t]), lwd=2,\n     ylab=expression(X[t+2]), ylim=c(0,0.8))\nlines(x[480:780], m2^2*x[480:780]-m2^2*xstar2+xstar2,lty=2)\nlines(x,x)\n\n\n\n## this is what figure 3 should be\na &lt;- 3.414\nplot(x,eval(lmap2),type=\"l\",lwd=2,\n     xlab=expression(X[t]),ylab=expression(X[t+2]))\nlines(x[550:850], m1^2*x[550:850]-m1^2*xstar1+xstar1,lty=2)\nlines(x,x)\n\n\n\n\nIn the first figure (\\(a=2.707\\)), there is only one non-zero equilibrium. The tangent at this equilibrium is shallow and the equilibrium is stable. As we move to a higher growth rate (\\(a=3.414\\)), a valley deepens between the two peaks and a second equilibrium appears. Note that the slope of the tangent at both these equiliria is quite steep, indicating instability.\nNote that the valley between two peaks (even if it’s only shallow) isn’t a necessary consequence of plotting the second-order recursive map. If we use a growth rate, for example, more compatible with a human life cycle—albeit representing quite brisk growth—we get a qualitatively different plot. An intrinsic rate of increases of \\(r=0.02\\) translates into a value of \\(a=1.65\\).\n\n## human (r=0.02, r=0.04 yields a=2.718282)\na &lt;- 1.64872\nxh &lt;- eval(lmap2)\nplot(x,xh, type=\"l\", lwd=2,\n     xlab=expression(X[t]),ylab=expression(X[t+1]))\nlines(x,x)\n\n\n\n\nNo peaks/valley and ultra-stable equilibrium (slope of tangent near zero!).\nNow we increase \\(a\\) further.\n\n## chaotic region\na &lt;- 3.571\nplot(x,eval(lmap2),type=\"l\", lwd=2,\n     xlab=expression(X[t]),ylab=expression(X[t+2]))\nlines(x,x)\na &lt;- 3.414\nlines(x,eval(lmap2), lwd=2, col=grey(0.75))\n\n\n\n\n\n## human (r=0.02, r=0.04 yields a=2.718282)\na &lt;- 1.64872\nxh &lt;- eval(lmap)\nplot(x,xh, type=\"l\", lwd=2,\n     xlab=expression(X[t]),ylab=expression(X[t+1]))\nlines(x,x)\n\nxstarh &lt;- 1-(1/a)\n#[1] 0.3934689\nxhp &lt;- diff(xh)\n\n### search for the point near the equlibrium\nmax(which(x&lt;0.4))\n\n[1] 400\n\nx[394]\n\n[1] 0.3933934\n\n#[1] 0.3933934\nmh &lt;- xhp[393]/xp[393]\nlines(x[300:500], mh*x[300:500]-mh*xstarh+xstarh,lty=2)\ntext(0.2,0.4, expression(paste(lambda, \"=0.3532\", sep=\"\")))\n\n\n\n\n\n## May (1976) Figure 5\nlmap3 &lt;- expression(a*(a*(a*x*(1-x))*(1-(a*x*(1-x))))*(1-(a*(a*x*(1-x))*(1-(a*x*(1-x))))))\na &lt;- 3.7\nx3 &lt;- eval(lmap3)\nplot(x,x3, type=\"l\",lwd=2,\n     xaxs=\"i\", yaxs=\"i\",\n     xlim=c(0,1),\n     ylim=c(0,1),\n     xlab=expression(X[t]),ylab=expression(X[t+3]))\na &lt;- 3.9\nlines(x,eval(lmap3), lwd=2, col=grey(0.75))\nlines(x,x)\n\n\n\n\nSix equilibria.\nAs we keep cranking up the growth rate, the periods double, we can track how this happens by plotting the number of periods as a function of the growth rate.\n\nn &lt;- 1\nR &lt;- seq(2.5,4,length=1000)\nf &lt;- expression(a*x*(1-x))\ndata &lt;- matrix(0,200,1001)\n\nfor(a in R){\n  x &lt;- runif(1) # random initial condition\n  ## first converge to attractor\n  for(i in 1:200){\n    x &lt;- eval(f)\n  } # collect points on attractor\n  for(i in 1:200){\n    x &lt;- eval(f)\n    data[i,n] &lt;- x\n  }\n  n &lt;- n+1\n}\n\ndata &lt;- data[,1:1000]\nplot(R,data[1,], pch=\".\", xlab=\"a\", ylab=\"X\")\nfor(i in 2:200) points(R,data[i,], pch=\".\")\n\n\n\n\nChaos!\nThis is all a prelude to the question that turns out to be essential for disease ecology.\n\n2.2.1 Why Do Rodent Populations Cycle?\nRodents are common reservoirs for a variety of zoonoses. Yates et al. (2002) attribute the origin of Sin Nombre virus in the Desert Southwest, in part, to the high density of deer mice, Peromyscus maniculatus. High densities of rodents are implicated in Lyme disease, Babesiosis, Plague, Lassa fever, Leptospirosis, and others.\nUsing the insights of the last section, we can begin to see why rodent densities might cycle.\n\ncole &lt;- function(L,a,w,R,b,p)  p*(L^-1) + R*b*(L^-a) - R*b*(p^(w - a +1))*(L^-(w+1)) - 1\n\n# mice, per month\nuniroot(cole, lower=1, upper=5, extendInt=\"yes\", \n        a=2.58, b=0.67, w=100, R=0.25, p=0.98)\n\n$root\n[1] 1.120025\n\n$f.root\n[1] 7.742e-06\n\n$iter\n[1] 5\n\n$init.it\n[1] NA\n\n$estim.prec\n[1] 6.103516e-05\n\n## monthly growth rate\na &lt;- uniroot(cole, lower=1, upper=5, extendInt=\"yes\", \n             a=2.58, b=0.67, w=100, R=0.25, p=0.98)$root^12\n### Dynamics\n# logistic map\nlmap &lt;- function(a,x) a*x*(1-x)\n\n## time series\nx0 &lt;- runif(1)\ntmax &lt;- 100\ny &lt;- rep(0,(tmax+1))\ny[1] &lt;- x0\n\nfor(t in 2:(tmax+1)) y[t] &lt;- lmap(a=a,x=y[t-1])\n\nplot(seq(0,tmax),y, type=\"l\", xlab=\"Time\", ylab=\"Population Size\")\n\n\n\n\nAs we’ve seen in Section 2.2, when the growth rate is high enough—and popualtions are ultimately regulated by density—the the population will cycle erratically. If it’s really high, it will enter the chaotic domain.\nThe logistic model has a symmetric recuritment function, but this need not be the case. Ricker recruitment is highly asymmetric. It arises from scramble competition.\n\n## Ricker Recruitment\nricker &lt;- function(n,r,k) n*exp(r*(1-(n/k)))\nxx &lt;- seq(0,250,by=0.1)\nk &lt;- 100\nR &lt;- a\nxr &lt;- ricker(n=xx,r=R,k=k)\n\n\nplot(xx,xr, type=\"l\", lwd=2, yaxs=\"i\",\n     xlab=expression(X[t]),ylab=expression(X[t+1]),\n     ylim=c(0,500), xaxs=\"i\")\nlines(xx,xx,lwd=2, col=\"red\")\n\n\n\n\nWe can cobweb this.\n\nricker.recruit &lt;- function(r0,K,N) N*exp(r0*(1-(N/K)))\nr0 &lt;- 3\nK &lt;- 50\nN &lt;- 0:150\nplot(N,ricker.recruit(r0=r0,K=K,N=N), type=\"l\", col=\"black\", lwd=3, yaxs=\"i\",\n     ylim=c(0,140),\n     xlab=\"Current Number of Infections\", ylab=\"New Infections\")\nabline(a=0,b=1, lwd=2, col=grey(0.75))\n\n\n## cobweb -- give it a couple spins around\n\nn0 &lt;- 25\ny &lt;- ricker.recruit(r0=r0,K=K,N=n0)\nsegments(n0,0,n0,y, col=\"red\") #vertical 1\nsegments(n0,y,y,y, col=\"red\") # horizontal 1\ny1 &lt;- ricker.recruit(r0=r0,K=K,N=y)\nsegments(y,y,y,y1, col=\"red\") #vertical 2\nsegments(y,y1,y1,y1, col=\"red\") #horizontal 2\ny2 &lt;- ricker.recruit(r0=r0,K=K,N=y1)\nsegments(y1,y1,y1,y2, col=\"red\") #vertical 3\nsegments(y1,y2,y2,y2, col=\"red\") #horizontal 3\ny3 &lt;- ricker.recruit(r0=r0,K=K,N=y)\nsegments(y,y,y,y3, col=\"red\") #vertical 4\nsegments(y,y3,y3,y3, col=\"red\") #horizontal 4\ny4 &lt;- ricker.recruit(r0=r0,K=K,N=y1)\nsegments(y1,y1,y1,y4, col=\"red\")\n\n\n\n\nThe cobwebbing shows how the Ricker recruitment function (when the growth rate is high) repeatedly overcompensates. When population density is low, it grows fast, exceeding the carrying capacity and subsequently crashing. This just keeps going, as we can see by letting the cobwebbing go for more iterations.\n\n## another try, with a lot more spins\nplot(N,ricker.recruit(r0=r0,K=K,N=N), type=\"l\", col=\"black\", lwd=3, yaxs=\"i\",\n     ylim=c(0,150),\n     xlab=\"Current Number of Infections\", ylab=\"New Infections\")\nabline(a=0,b=1, lwd=2, col=grey(0.75))\nt=50\ny &lt;- rep(0,t)\ny[1] &lt;- ricker.recruit(r0=r0,K=K,N=n0)\nfor(i in 2:t)  y[i] &lt;- ricker.recruit(r0=r0,K=K,N=y[i-1])\n\nsegments(n0,0,n0,y[1], col=\"red\")\nsegments(n0,y[1],y[1],y[1], col=\"red\")\nfor(i in 2:(t-2)){\n    segments(y[i],y[i],y[i],y[i+1], col=\"red\") #vertical\n    segments(y[i],y[i+1],y[i+1],y[i+1], col=\"red\") #horiz\n    segments(y[i+1],y[i+1],y[i+1],y[i+2], col=\"red\") #vert\n    segments(y[i+1],y[i+2],y[i+2],y[i+2], col=\"red\") #horiz\n}\n\n\n\n\nWhat does the Ricker time series look like?\n\n## Ricker Time Series\nx0 &lt;- runif(1)\ntmax &lt;- 100\ny &lt;- rep(0,(tmax+1))\ny[1] &lt;- x0\n\nfor(t in 2:(tmax+1)) y[t] &lt;- ricker(n=y[t-1],r=a,k=k)\n\nplot(seq(0,tmax),y, type=\"l\", xlab=\"Time\", ylab=\"Population Size\")\n\n\n\n\nFunctional response by predators combined with density-dependence of prety stabilizes the Lotka-Voltera model. They also check the growth rate of high-productivity species like rodents.\n\n# Rosenzweig & MacArthur (1963) model\n# Using Stevens' Primer\nrequire(deSolve)\npredpreyRM &lt;- function(t, y, p) {\n  H &lt;- y[1]\n  P &lt;- y[2]\n  with(as.list(p), {\n   dH.dt &lt;- b * H * (1 - alpha * H) - w * P * H/(D + H)\n   dP.dt &lt;- e * w * P * H/(D + H) - s * P\n   return(list(c(dH.dt, dP.dt)))\n  }) \n}\n\n# Stevens: a = w/D = attack rate of LV (H -&gt; 0)\n\nb &lt;- 0.8\ne &lt;- 0.07\ns &lt;- 0.2\nw &lt;- 5\nD &lt;- 400\nalpha &lt;- 0.001\nH &lt;- 0:(1/alpha)\n\nHiso &lt;- expression(b/w * (D + (1 - alpha * D) * H - alpha * H^2))\nHisoStable &lt;- eval(Hiso)\n\np.RM &lt;- c(b = b, alpha = alpha, e = e, s = s, w = w, D = D)\ntmax &lt;- 150\ntimes &lt;- seq(0,tmax,by=0.1)\nRM1 &lt;- as.data.frame(ode(c(900, 120), times, predpreyRM, p.RM))\ncolnames(RM1) &lt;- c(\"time\",\"prey\",\"predator\")\n\nplot(RM1[,\"time\"], RM1[,\"prey\"], type=\"l\", lwd=2, col=\"blue\", xaxs=\"i\",\n     xlab=\"Time\", ylab=\"Population Size\",\n     ylim=c(0,900))\nlines(RM1[,\"time\"], RM1[,\"predator\"], col=\"orange\", lwd=2)\nlegend(\"topright\",c(\"Predator\",\"Prey\"), col=c(\"orange\",\"blue\"),lwd=2)\n\n\n\n## phase portrait\nplot(RM1[,\"prey\"], RM1[,\"predator\"], type=\"l\", lwd=2, col=\"magenta\", \n     xlab=\"Prey Population\", ylab=\"Predator Population\")\n\n\n\n## Jacobian of LV\ndhdt &lt;- expression(b * H * (1 - alpha * H) - w * P * H/(D + H))\ndpdt &lt;- expression(e * w * P * H/(D + H) - s * P)\n\nRMjac1 &lt;- list(D(dhdt, \"H\"), D(dpdt, \"H\"), D(dhdt, \"P\"), D(dpdt, \"P\"))\nH &lt;- s * D/(e * w - s)\nP &lt;- eval(Hiso)\n(RM.jac2 &lt;- matrix(sapply(RMjac1, function(pd) eval(pd)), nrow = 2))\n\n           [,1]      [,2]\n[1,] -0.2133333 -2.857143\n[2,]  0.0112000  0.000000\n\neigen(RM.jac2)[[\"values\"]]\n\n[1] -0.1066667+0.1436044i -0.1066667-0.1436044i\n\n## plot functional response\n# revert to this value of H:\nholling2 &lt;- expression(a * x/(1 + a*h*x))\nx &lt;- 0:100\na &lt;- 0.2\nh &lt;- 0.25\n\nplot(x,eval(holling2), type=\"l\", col=\"purple\", lwd=2, yaxs=\"i\",\n     xlab=\"Prey Population Size\", ylab=\"Number of Prey Consumed\", ylim=c(0,3.5))\n\n\n\n\nAdd predators and rodents stop cycling. Extirpate generalist predators (e.g., coyotes) and you get the potential for explosive (and erratic) rodent growth."
  },
  {
    "objectID": "ecology.html#metapopulations",
    "href": "ecology.html#metapopulations",
    "title": "2  Ecology",
    "section": "2.3 Metapopulations",
    "text": "2.3 Metapopulations"
  },
  {
    "objectID": "ecology.html#multi-host-epidemics",
    "href": "ecology.html#multi-host-epidemics",
    "title": "2  Ecology",
    "section": "2.4 Multi-Host Epidemics",
    "text": "2.4 Multi-Host Epidemics\nM. Woolhouse et al. (1997) and M. E. J. Woolhouse, Taylor, and Haydon (2001): 80/20 rule\n\n2.4.1 Multi-Host Epidemic Isoclines\nHolt et al. (2003)\n\n## Non-interacting\nx &lt;- seq(1,10,,500)\nx1 &lt;- seq(0,9,,100)\n\nplot(x,x, type=\"n\", axes=FALSE, frame=TRUE, xlab=\"Species 1\", ylab=\"Species 2\")\naxis(1,at=c(7), labels=c(expression(hat(S)[1])))\naxis(2,at=c(7), labels=c(expression(hat(S)[2])))\nrect(par(\"usr\")[1], par(\"usr\")[3],\n     par(\"usr\")[2], par(\"usr\")[4],\n     col = grey(0.95))\nrect(par(\"usr\")[1], par(\"usr\")[3],\n     7, 7, col=\"white\")\n#polygon(c(x1,rev(x1)), c(x1,rev(x1)), col=\"green\", border=FALSE)\nsegments(0,7,7,7, lwd=3, col=\"red\")\nsegments(7,0,7,7, lwd=3, col=\"red\")\ntext(5,5, expression(R[0]&lt;1))\ntext(8,8, expression(R[0]&gt;1))\n\n\n\n\n\n## Weakly Interactions\n## This one is tricky to get the polygon on, so invert:\n## draw the polygon under and make that white on top of a \n## background rectangle the dimensions of the plot that is grey\n\ng &lt;- seq(0,sqrt(1/5),length=100)\nh &lt;- sqrt(1-(5*g^2))\nplot(g,h, type=\"n\", \n     axes=FALSE, frame=TRUE, \n     yaxs=\"i\", xaxs=\"i\", \n     ylim=c(0,1.1), xlim=c(0,0.5),  \n     xlab=\"Spcies 1\", ylab=\"Species 2\")\nrect(par(\"usr\")[1], par(\"usr\")[3],\n     par(\"usr\")[2], par(\"usr\")[4],\n     col = grey(0.95))\npolygon(c(g[1],g),c(0,h),col=\"white\", border=FALSE)\nlines(g,h,col=\"red\", lwd=3)\naxis(1,at=c(0.4485), labels=c(expression(hat(S)[1])))\naxis(2,at=c(1), labels=c(expression(hat(S)[2])))\ntext(0.37, 0.8, expression(R[0]&gt;1))\ntext(0.23,0.63, expression(R[0]&lt;1))\n\n\n\n\n\n## Substitutable\n\nm &lt;- (0.8432192-0.1235539)/(1.230762-8.257112)\nb &lt;- 0.8432192-(-m*1.230762)\nxint &lt;- -b/m\n\nplot(x, 1/x, type=\"n\", lwd=3, col=\"red\", xlim=c(1.5,9), ylim=c(0.15,1/1.2), axes=FALSE,\n     xlab=\"Species 1\", ylab=\"Species 2\")\nbox()\npolygon(c(seq(1,10,length=100), seq(10,1,length=90)), c(m*seq(1,8.257112,length=100)+1.2*b, rep(8.257112,90)),\n        col=grey(0.95), border=\"red\", lwd=3)\n#segments(1.230762,0.8432192,8.257112,0.1235539, lwd=3, col=\"red\")\naxis(1,at=c(8.7), labels=c(expression(hat(S)[1])))\naxis(2,at=c(0.7423), labels=c(expression(hat(S)[2])))\ntext(6.5, 0.56, expression(R[0]&gt;1))\ntext(3,0.3, expression(R[0]&lt;1))\n\n\n\n\n\n## Complementary\n\nplot(x, 1/x, type=\"l\", lwd=3, col=\"red\", xlim=c(1.5,9), ylim=c(0.15,1/1.2), axes=FALSE,\n     xlab=\"Species 1\", ylab=\"Species 2\")\nbox()\npolygon(c(seq(1,10,by=0.1), seq(9,1,by=-0.1)), c(1/seq(1,10,by=0.1), rep(10,81)), col=grey(0.95), border=\"red\")\naxis(1,at=c(8.12), labels=c(expression(hat(S)[1])))\naxis(2,at=c(0.8325), labels=c(expression(hat(S)[2])))\ntext( 5, 0.32, expression(R[0]&gt;1))\ntext(2.5, 0.24, expression(R[0]&lt;1))\n\n\n\n\n\n## Alternating\nx &lt;- seq(0,10,,100)\ny &lt;- 2/x\n\nplot(x,y,type=\"n\", axes=FALSE, frame=TRUE, xlab=\"Species 1\",\n     ylab=\"Species 2\", xlim=c(0,7), ylim=c(0,7))\npolygon(c(x,rev(x)), c(y,rep(8,100)), col=grey(0.95))\nlines(x,y, lwd=3, col=\"red\")\ntext(0.65, 0.61, expression(R[0]&lt;1))\ntext(2.7, 2.1, expression(R[0]&gt;1))\n\n\n\n\n\n## Inhibitory\n\nx &lt;- seq(1,15,,100)\ny &lt;- -15 + 2*x\n\nx1 &lt;- seq(8,15,,100)\ny1 &lt;- -15 + 2*x1\n\nplot(1:15,1:15,type=\"n\", xaxs=\"i\", yaxs=\"i\",\n     axes=FALSE, frame=TRUE, xlab=\"Species 1\", ylab=\"Species 2\")\naxis(1,at=c(8), labels=c(expression(hat(S)[1])))\n#polygon(c(8,8:15, col=grey(0.95)))\npolygon(c(x1[1],x1,x1[100]), c(1,y1,1), col=grey(0.95), border=FALSE)\ntext(12,4.2, expression(R[0]&gt;1))\ntext(7.5, 5.2, expression(R[0]&lt;1))\nlines(x,y, lwd=3, col=\"red\")"
  },
  {
    "objectID": "ecology.html#the-two-big-ideas-in-disease-ecology",
    "href": "ecology.html#the-two-big-ideas-in-disease-ecology",
    "title": "2  Ecology",
    "section": "2.5 The Two Big Ideas in Disease Ecology",
    "text": "2.5 The Two Big Ideas in Disease Ecology\n\n2.5.1 The Dilution Effect\nThe relationship between biodiversity and disease risk is probably the fundamental debate in disease ecology.\nDilution and Lyme, the model: - Forest destruction and fragmentation leads to reduced species diversity - White-footed mice capitalize and tend to increase in density in disturbed habitats - Increased mouse density leads to increased human exposure - Allan et al. (2003): Nymphal infection prevalence declined linearly with increasing fragment size - Exponential decline in nymphal density with increasing patch size - Note that all of these papers from the Ecosystem Studies folks (Ostfeld, Keesing, LoGuidice, et al.) use prevalence as their measure of risk - Using this measure hides a big assumption - This assumption is that there is a trade-off between the presence of one species (e.g., white-footed mice) and another (e.g., chipmunks) - If the host population size is not approximately constant, prevalence is not an appropriate measure of risk! - There is a desperate need to count ticks!\nRandolph and Dobson (2012) note that (perhaps obviously) ticks are not mosquitoes. Mosquito density is determined in host-independent ways, while tick density is determined in host-dependent ways (because they are parasitic at all life-cycle stages). They write, “Examination of the theoretical and empirical evidence for this hypothesis reveals that it applies only in certain circumstances even amongst tick-borne diseases, and even less often if considering the correct metric—abundance rather than prevalence of infected vectors. Whether dilution or amplification occurs depends more on specific community composition than on biodiversity per se.”\n\n\n2.5.2 The Resource-Pulse Hypothesis\nSometimes called “Trophic Cascade” (e.g., in Yates et al. 2002). This is problematic, as noted by Stapp (2007) since a trophic cascade is a top-down process and the mechanism described, e.g., by Yates et al. (2002) is bottom-up. The idea of a trophic cascade is attributable to Hairston et al. (1960) and is sometimes known as the green-world hypothesis. Remove predators and grasslands will be over-grazed. As Stapp notes, what Yates and colleagues (and various disease ecologists who followed) describe is actually a trophic amplification.\nFor example, Yates et al. (2002) attribute the emergence of the paradoxically-named Sin Nombre Hantavirus in the desert Southwesst of the US in 1993 to what they call a “trophic cascade”: “Evidence from two El Niño episodes in the American Southwest suggests that El Niño–driven precipitation, the initial catalyst of a trophic cascade that results in a delayed density-dependent rodent response, is sufficient to predict heightened risk for human contraction of hantavirus pulmonary syndrome.”\n\n\n\n\nHolt, R. D., A. P. Dobson, M. Begon, R. G. Bowers, and E. M. Schauber. 2003. “Parasite Establishment in Host Communities.” Ecology Letters 6 (9): 837–42. https://doi.org/10.1046/j.1461-0248.2003.00501.x.\n\n\nMay, R. M. 1976. “Simple Mathematical-Models with Very Complicated Dynamics.” Nature 261 (5560): 459–67. https://doi.org/10.1038/261459a0.\n\n\nRandolph, S. E., and A. D. M. Dobson. 2012. “Pangloss Revisited: A Critique of the Dilution Effect and the Biodiversity-Buffers-Disease Paradigm.” Parasitology, 1–17. https://doi.org/10.1017/S0031182012000200.\n\n\nWoolhouse, M. E. J., L. H. Taylor, and D. T. Haydon. 2001. “Population Biology of Multihost Pathogens.” Science 292 (5519): 1109–12. https://doi.org/10.1126/science.1059026.\n\n\nWoolhouse, ME, C Dye, JF Etard, T Smith, JD Charlwood, GP Garnett, P Hagan, et al. 1997. “Heterogeneities in the Transmission of Infectious Agents: Implications for the Design of Control Programs.” Proceedings of the National Academy of Sciences of the United States of America 94 (1): 338–42. https://doi.org/10.1073/pnas.94.1.338.\n\n\nYates, Terry L., James N. Mills, Cheryl A. Parmenter, Thomas G. Ksiazek, Robert R. Parmenter, John R. Vande Castle, Charles H. Calisher, et al. 2002. “The Ecology and Evolutionary History of an Emergent Disease: Hantavirus Pulmonary Syndrome.” Bioscience 52 (11): 989–98. https://doi.org/10.1641/0006-3568(2002)052[0989:teaeho]2.0.co;2."
  },
  {
    "objectID": "evolution.html#phylogenetic-trees",
    "href": "evolution.html#phylogenetic-trees",
    "title": "3  Evolution",
    "section": "3.1 Phylogenetic Trees",
    "text": "3.1 Phylogenetic Trees\nPhylogenetic analysis is an important tool for disease ecologists. Phylogenies can give us clues about the origins of pathogens, especially their relationships to other pathogens and the timing of their emergence and other important evolutionary transitions such as the aquisition of increased virulence. A phylogeny is a hypothesis of the evolutionary relationships between a group of taxa typically represented in a phylogenetic tree. A tree is a special graph (as in graph theory) which is connected and lacks cycles. Trees represent nested relationships. Every taxon within a clade is more closely related to each other than any are to anything outside the clade.\n\n3.1.1 Phylogeny Terms\nPhylogeny A hypothesis of the evolutionary relationships between a group of taxa, typically represented in a phylogenetic tree. A tree is a special graph which is connected and lacks cycles.\nIt’s important to know to read a phylogenetic tree. The tree represents nested relationships. Every taxon within a clade is more closely related to each other than any are to anything outside the clade. This means that you can rotate the terminal nodes around an internal node (i.e., a clade) and retain the same relationships. For example, if species \\(B\\) and \\(C\\) (along with their common ancestor) form a clade and \\(A\\) is an outgroup, then the nested relationships can be represented as \\((A,(B,C))\\). The following trees represent the same relations regardless of the ordering of \\(B\\) and \\(C\\) is the graphical representation of the phylogeny.\n\n\n\n\n\n\n\n\nCladogram A form of representing evolutionary relationships in which branch lengths are meaningless (usually same length).\nChronogram A form of representing evolutionary relationships in which branch lengths are proportional to time. The distance from root to leaf is the same for every leaf.\nPhylogram A form of representing evolutionary relationships in which branch lengths are proportional to evolutionary divergence. The distance from root to leaf is not the same for every leaf.\nClade An ancestor and all its descendants.\nLeaves are the extant taxa in a phylogeny, also terminal nodes.\nApomorphy A new (i.e., derived) character that arose through evolution. A synapomorphy is a shared-derived characteristic. A plesiomorphy is an ancestral character (which is therefore not useful for inferring relationships).\nNode A vertex in the graph representing the evolutionary relations. A node can be internal, where it represents the point where one lineage splits into two or more lineages. A node can also be terminal, where it represents the present-day lineage.\nOutgroup A more distantly-related taxon to the group of taxa whose relations are being represented. Allows the phylogeny to be rooted. While an outgroup must be more distantly-related than the taxa under consideration, it must be closely-enough related to allow meaningful comparisons to the ingroup.\nSister Group The group most closely related to the taxon under consideration. Marburg Virus is the sister group to Ebola Virus.\nParaphyletic A tree is paraphyletic if it contains an ancestor but excludes some or all of its descendants. Both HIV-1 and HIV-2 are paraphyletic groups because the naming convention excludes descendants from a common ancestor: SIVcpz in the case of HIV-1 and SIVsm in the case of HIV-2.\nPolyphyletic An evolutionary hypothesis is polyphyletic if a group of taxa is derived from more than one common ancestor. The category of “HIV” is polyphyletic because HIV-1 and HIV-2 are derived from different ancestors."
  },
  {
    "objectID": "evolution.html#inference-for-historical-population-dynamics",
    "href": "evolution.html#inference-for-historical-population-dynamics",
    "title": "3  Evolution",
    "section": "3.2 Inference For Historical Population Dynamics",
    "text": "3.2 Inference For Historical Population Dynamics"
  },
  {
    "objectID": "evolution.html#other-terms",
    "href": "evolution.html#other-terms",
    "title": "3  Evolution",
    "section": "3.3 Other Terms",
    "text": "3.3 Other Terms\nDegeneracy For some amino acids, there is a multiplicity of codons (triplets of DNA or RNA nucleotides that code for an amino acid or a stop) that specify a particular amino acid.\nSynonymous Substitution Mutation where the substitution of one nucleotide for another has no effect on the resulting amino acid that is coded for.\n\n3.3.1 Selective Constraint\n\nMeasured using a dn/ds (or Ka/Ks) ratio\nAmino acids are determined by codons, sets of three bases in DNA or mRNA\nThere are four bases at three positions in a codon, therefore are \\(4^3=64\\) possible codons\nBut there are only 20 amino acids being coded for\nThis means there is degeneracy in the genetic code\nSome amino acids are coded by 2, 3, 4, or more codons\nThe degeneracy occurs in the third codon position\nWhen a mutation changes a base at a third-position in a codon, it may have no effect on the resulting amino acid, because of the degeneracy of the code\nSelection is therefore much weaker on such synonymous substitutions\nA measure of selective looks at the ratio of synonymous substitutions to non-synonymous substitutions\nWhen this ratio is high, there is strong evidence of positive selection\nWhen the ratio is very low, there is evidence of selective constraint"
  },
  {
    "objectID": "evolution.html#virulence-evolution",
    "href": "evolution.html#virulence-evolution",
    "title": "3  Evolution",
    "section": "3.4 Virulence Evolution",
    "text": "3.4 Virulence Evolution\nSome plots from Frank (1996).\n\n## Figure 3 (Frank 1996)\nvstar &lt;- expression(s*(delta+gamma)/(r-s))\ns &lt;- seq(0,1,length=1000)\ndelta &lt;- 0.3\ngamma &lt;- 0.7\n\n## r=0.1\nr &lt;- 0.1\nvr01 &lt;- eval(vstar)\n\n## r=0.5\nr &lt;- 0.5\nvr05 &lt;- eval(vstar)\n\n## r=1.0\nr &lt;- 1\nvr1 &lt;- eval(vstar)\n\n## transmissibility is assumed to be a power function of virulence\n## beta(v) = b*v^s, s \\in (0,1)\n\nplot(s[vr1&gt;0],vr1[vr1&gt;0], log=\"y\", type=\"l\", lwd=2, ylim=c(0.1,100),\n     xlab=\"Transmission Exponent (s)\", ylab=\"Equilibrium Virulence (v*)\")\nlines(s[vr05&gt;0],vr05[vr05&gt;0], lwd=2)\nlines(s[vr01&gt;0],vr01[vr01&gt;0], lwd=2)\ntext(0.17,10,\"r=0.1\")\ntext(0.53,10,\"r=0.5\")\ntext(0.98,10, \"r=1.0\")\n\n\n\n\n\n## Frank (1996) figure 4 (kind of -- it's a cross-section of his false 3d plot)\nvstar1 &lt;- expression( (gamma*tau/r)^(1/(tau+1)) )\ntau &lt;- seq(0,4, length=1000)\ngamma &lt;- 0.5\n\n\nr &lt;- 0.1\nplot(tau,eval(vstar1), type=\"l\",  lwd=2,\n      xlab=expression(paste(\"Clearance Exponent (\", tau, \")\", sep=\"\")),\n      ylab=\"Virulence (v*)\")\n\nr &lt;- 0.5\nlines(tau,eval(vstar1), lwd=2)\n\nr &lt;- 1\nlines(tau,eval(vstar1), lwd=2)\ntext(3.5,1.98,\"r=0.1\")\ntext(3.5,1.4,\"r=0.5\")\ntext(3.5,1.21,\"r=1.0\")\n\n\n\n\n\n### Frank (1996) Figure 2\nlambda &lt;- 1\nk &lt;- seq(1,256, length=1000)\nm &lt;- 1.0\nrrr &lt;- expression( (k-(k-1)*((1-m)^2))^-1 )\nr &lt;- eval(rrr)\nvstar &lt;- expression( lambda*(1-r)/(lambda*(1-r) + r) )\npdf(\"superinfection.pdf\", height=5,width=8)\nplot(k, eval(vstar), type=\"l\", lwd=2, log=\"x\", xaxs=\"i\", ylim=c(0,1),\n     xlab=\"Strains per Host\", ylab=\"Virulence\")\n\n## m=0.1\nm &lt;- 0.1\nr &lt;- eval(rrr)\nlines(k, eval(vstar), lwd=2)\n\n# m=0.01\nm &lt;- 0.01\nr &lt;- eval(rrr)\nlines(k, eval(vstar), lwd=2)\n\n#locator(3)\nx &lt;- c(2.633309,  5.113474, 15.110922)\ny &lt;- c(0.73, 0.555, 0.33)\ntext(x[1],y[1],expression(m == 1))\ntext(x[2],y[2],expression(m == 0.1))\ntext(x[3],y[3],expression(m == 0.01))\n\n\n\n\n\nFrank, S. A. 1996. “Models of Parasite Virulence.” Quarterly Review of Biology 71 (1): 37–78. https://doi.org/10.1086/419267."
  },
  {
    "objectID": "mixing.html#sec-struct",
    "href": "mixing.html#sec-struct",
    "title": "4  Mixing",
    "section": "4.1 Flattening the Epidemic Curve When Mixing Is Heterogeneous",
    "text": "4.1 Flattening the Epidemic Curve When Mixing Is Heterogeneous\nWe have recently emerged from a major pandemic of the SARS-CoV-2 virus, a.k.a., COVID-19. One of the major concerns of COVID-19 was that there is a substantial subpopulation that was particularly vulnerable to serious complications and death from infection. In particular, COVID-19 is especially dangerous for the elderly.\nThis observation leads to some obvious public-health policy questions. What is the best way to protect a vulnerable subpopulation? In particular, should we isolate members of vulnerable sub-populations through quarantine or social-distancing efforts?\nWe can use our simple structured-mixing model to investigate what happens when we reduce the contact rates (e.g., through social distancing efforts) of the high-risk population, the lower-risk population, or both.\nWe will explore four sets of parameters reflecting:\n\nBaseline conditions\nReduction of contact rates with the high-risk subpopulation\nReduction of contact rates with the low-risk subpopulation\nGlobal reduction of contact rates\n\nWe assume that the contact rates within the low-risk subpopulation are higher than either the contact rates within the high-risk subpopulation or between subpopulations. This assumption follows from the fact that the high-risk subpopulation is older and less likely to be engaged in the workforce, etc. We retain the assumption from above that there is an asymmetry in transmission between groups. This arises from the fact that caretakers of the elderly are typically younger and therefore in the low-risk subpopulation. A sick elderly person is more likely to transmit to their young caregiver than a young person is to an elderly individual. As with everything else, this is an assumption that can be played around with and perhaps even left as an exercise.\nWe should think a bit about mortality rates. These are necessarily higher in the high-risk subpopulation (that’s what makes them high-risk). Note, however, that in the equations describing our structured SIR model, we simply have a constant removal rate. The term “removal rate” covers a multitude of sins. One can be removed from the infectious compartment by a number means, e.g., through recovery, death, quarantine, emigration from the affected region, etc. In order not to complicate our simple model too much, we will simply retain the assumption that our \\(\\nu_i\\) terms incorporate both recovery and mortality. Since it is quite likely that there could actually be opposite effects on the \\(\\nu_i\\) if people in the high-risk population experience greater mortality rates but also slower recovery. For now, we’ll stick with a single removal rate, \\(\\nu\\). While the details of recovery and mortality rates would be very important if we were developing a tactical model to help with formulating detailed policy recommendations, our model here is strategic and more concerned with acquiring a general understanding of the consequences of changed contact rates on epidemic dynamics.\nWe will also modify the starting population since there are fewer people in the high-risk subpopulation.\nWe will assume that we can cut the contact rates with the high-risk subpopulation in half, but that we can’t reduce the contact rates with the low-risk subpopulation as much. This follows from the fact that members of the high-risk subpopulation are more likely to not be engaged in the workforce and may be more easily epidemiologically isolated.\nAs I said above, all these assumptions can be modified and you should probably expect future assignments in which you will be asked to investigate departures from the simple model presented here.\nBecause we are slowing down the epidemic, we will also extend the time over which we integrate the model.\n\n# baseline from before\nparms1 &lt;- c(N=N, beta11=0.5, beta12=0.15, beta22=0.5, beta21=0.05, nu=1/5)\n# reduce high-risk contact\n## beta21 and beta22 define transmission to group 2 and incorporate\n## contact rates along with transmissibility\n## reduce these betas by half\nparms2 &lt;- c(N=N, beta11=0.5, beta12=0.15, beta22=0.25, beta21=0.025, nu=1/5)\n# reduce low-risk contact\n# assume we can only reduce by a third\nparms3 &lt;- c(N=N, beta11=0.335, beta12=0.1, beta22=0.5, beta21=0.05, nu=1/5)\n# reduce both\nparms4 &lt;- c(N=N, beta11=0.335, beta12=0.1, beta22=0.25, beta21=0.025, nu=1/5)\nz0 &lt;- c(2*(N-1)/3,0.5,0,(N-1)/3,0.5,0,1)\ntimes &lt;- seq(0,600,1)\n\nNow run the models.\n\n## baseline\nstateMatrix1 &lt;- ode(y=z0, times, hsir, parms1)\ncolnames(stateMatrix1) &lt;- c(\"Time\",\"S1\",\"I1\",\"R1\",\"S2\",\"I2\",\"R2\",\"C\")\n## reduce high-risk contact\nstateMatrix2 &lt;- ode(y=z0, times, hsir, parms2)\ncolnames(stateMatrix2) &lt;- c(\"Time\",\"S1\",\"I1\",\"R1\",\"S2\",\"I2\",\"R2\",\"C\")\n## reduce low-risk contact\nstateMatrix3 &lt;- ode(y=z0, times, hsir, parms3)\ncolnames(stateMatrix3) &lt;- c(\"Time\",\"S1\",\"I1\",\"R1\",\"S2\",\"I2\",\"R2\",\"C\")\n## reduce both\nstateMatrix4 &lt;- ode(y=z0, times, hsir, parms4)\ncolnames(stateMatrix4) &lt;- c(\"Time\",\"S1\",\"I1\",\"R1\",\"S2\",\"I2\",\"R2\",\"C\")\n\n## plot epidemic curves\n# baseline\nplot(stateMatrix1[,\"Time\"], (stateMatrix1[,\"I1\"] + stateMatrix1[,\"I2\"]), \n  type=\"l\", lwd=2, col=\"black\",\n  xlab=\"Time\", ylab=\"Number of Cases\")\n# reduce high-risk\nlines(stateMatrix2[,\"Time\"], (stateMatrix2[,\"I1\"] + stateMatrix2[,\"I2\"]), \n      lwd=2, col=\"blue\")\n# reduce low-risk\nlines(stateMatrix3[,\"Time\"], (stateMatrix3[,\"I1\"] + stateMatrix3[,\"I2\"]), \n      lwd=2, col=\"cyan\")\n# reduce both\nlines(stateMatrix4[,\"Time\"], (stateMatrix4[,\"I1\"] + stateMatrix4[,\"I2\"]), \n      lwd=2, col=\"magenta\")\nlegend(\"topright\", c(\"Baseline\",\"Reduce High-Risk\", \"Reduce Low-Risk\", \"Reduce Both\"), col=c(\"black\",\"blue\",\"cyan\",\"magenta\"), lwd=2)\n\n\n\n\nWe should probably check that these dramatic differences in epidemic curves are not simply driven by changes in the low-risk population, though the dramatic differences in the peak size of the epidemic is reassuring.\n\n## plot epidemic curves\n# baseline\nplot(stateMatrix1[,\"Time\"], stateMatrix1[,\"I2\"], \n  type=\"l\", lwd=2, col=\"black\",\n  xlab=\"Time\", ylab=\"Number of High-Risk Cases\")\n# reduce high-risk\nlines(stateMatrix2[,\"Time\"], stateMatrix2[,\"I2\"], lwd=2, col=\"blue\")\n# reduce low-risk\nlines(stateMatrix3[,\"Time\"], stateMatrix3[,\"I2\"], lwd=2, col=\"cyan\")\n# reduce both\nlines(stateMatrix4[,\"Time\"], stateMatrix4[,\"I2\"], lwd=2, col=\"magenta\")\nlegend(\"topright\", c(\"Baseline\",\"Reduce High-Risk\", \"Reduce Low-Risk\", \"Reduce Both\"), col=c(\"black\",\"blue\",\"cyan\",\"magenta\"), lwd=2)\n\n\n\n\nNote the very different range of the y-axis!\nThis stupidly simple model makes the stark point—one that I think is one of the most profound points in epidemiology—that if we want to control an epidemic in a heterogeneous population, we should target the segment of the population that generates the most infections. This will often be the same segment of the population that is least at-risk for the most severe consequences of infection. This model provides the logic underlying what may seem like draconian social-distancing interventions (e.g., closing schools, canceling public gatherings)."
  },
  {
    "objectID": "climate_change.html#plotting-climate-data",
    "href": "climate_change.html#plotting-climate-data",
    "title": "6  Climate Change",
    "section": "6.1 Plotting Climate Data",
    "text": "6.1 Plotting Climate Data\n\n6.1.1 Global Temperature Anomalies\n\n## https://data.giss.nasa.gov/gistemp/\ntemps &lt;- read.table(\"data/global-temp-anomalies1880-2023.txt\", skip=7, \n                    header=TRUE)\n## number of years = 145\ntemp.series &lt;- as.numeric(temps[1,2:13])/100\nfor(i in 2:145) temp.series &lt;- c(temp.series, as.numeric(temps[i,2:13])/100)\n## make into time series object\ntemp.series &lt;- as.ts(temp.series, start=1880, end=2023, frequency=12)\n## 1740 = 145*12 (months in the series)\nytk &lt;- seq(1,1740,by=120)\nyrs &lt;- seq(1880,2023,by=10)\n\n\nplot(temp.series, type=\"l\", axes=FALSE, frame=TRUE, xaxs=\"i\",\n     col=\"#07419e\",\n     xlab=\"Year\",\n     ylab=\"Global Temperature Anomaly\")\naxis(1,at=ytk,labels=yrs)\naxis(2)\n## by definition, mean=0\nabline(h=0)\n\n\n\n## fit loess line\ntlo &lt;- loess(as.numeric(temp.series) ~ seq(1,1740), span=1/6)\n\n## add loess line to time-series plot\nplot(temp.series, type=\"l\", axes=FALSE, frame=TRUE, xaxs=\"i\",\n     col=\"#07419e\",\n     xlab=\"Year\",\n     ylab=\"Global Temperature Anomaly\")\nlines(predict(tlo, data.frame(seq(1,1740))), col=\"magenta\", lwd=3)\n#lines(lowess(temp.series, f=0.0758), col=\"magenta\", lwd=3)\naxis(1,at=ytk,labels=yrs)\naxis(2)\nabline(h=0)\n\n\n\n\n\n\n6.1.2 Multivariate El Niño Index\n\nmei &lt;- read.table(\"data/mei-series2023.txt\", header=TRUE, skip=3, row.names = 1)\nmmm &lt;- as.numeric(mei[1,])\nfor(i in 2:46) mmm &lt;- c(mmm,as.numeric(mei[i,]))\nmmm &lt;- mmm[!is.na(mmm)]\ndd &lt;- 1:length(mmm)\nyticks &lt;- seq(1,541,by=48)\nyears &lt;- seq(1979,2024,by=4)\n\nelnino &lt;- mmm\nelnino[elnino&lt;0] &lt;- 0\nlanina &lt;- mmm\nlanina[lanina&gt;0] &lt;- 0\n\n## plot time series\nplot(mmm, type=\"l\", axes=FALSE, frame=TRUE, xaxs=\"i\", xlab=\"Year\", ylab=\"MEI\")\naxis(1,at=yticks,labels=years)\naxis(2)\npolygon(x=c(dd,rev(dd)), y=c(elnino,rep(0,length(dd))), col=\"magenta\")\npolygon(x=c(0,dd,rev(dd),0), y=c(0,lanina,rep(0,length(dd)),0), col=\"blue\")\nabline(h=0)"
  },
  {
    "objectID": "climate_change.html#southern-oscillation-index",
    "href": "climate_change.html#southern-oscillation-index",
    "title": "6  Climate Change",
    "section": "6.2 Southern Oscillation Index",
    "text": "6.2 Southern Oscillation Index\n\n### SOI Data (http://www.cpc.ncep.noaa.gov/data/indices/)\nsoi &lt;- read.table(\"data/soi-data1951-2023.txt\", skip=1, header=TRUE, row.names=1)\nsoi.series &lt;- as.numeric(soi[1,1:12])\nfor(i in 2:74) soi.series &lt;- c(soi.series, as.numeric(soi[i,]))\nsoi.series &lt;- soi.series[!is.na(soi.series)]\n\nytk1 &lt;- seq(1,878,by=48)\nyrs1 &lt;- seq(1951,2023,by=4)\n\nplot(soi.series, type=\"l\", axes=FALSE, frame=TRUE, xaxs=\"i\",\n     col=\"#a80840\",\n     xlab=\"Year\",\n     ylab=\"Standardized SOI\")\naxis(1,at=ytk1,labels=yrs1)\naxis(2)\nabline(h=0)\n\n\n\n## another way to add a local smoother\nplot(soi.series, type=\"l\", axes=FALSE, frame=TRUE, xaxs=\"i\",\n     col=\"#a80840\",\n     xlab=\"Year\",\n     ylab=\"Standardized SOI\")\naxis(1,at=ytk1,labels=yrs1)\naxis(2)\nabline(h=0)\nlines(lowess(soi.series, f=0.066), col=\"black\", lwd=3)\n\n\n\n\nTry some wavelets.\n\n## wavelets\nrequire(biwavelet)\n\n## biwavelet requires a two-column matrix as input\nX &lt;- cbind(1:877,soi.series)\n## wavelet transform\nw1 &lt;- wt(X)\n\n# plot\nplot(w1)\n\n\n\n\nWavelet spectrum, which combines the frequency and time domains of variability in ENSO. Clear evidence of a 5-year periodicity; some evidence of 3-year, 10-year. Possible decay of 5-year periodicity at later dates. Period in months.\nThe color indicates the power of the series at a particular period in a particular time. Power is the signal-processing equivalent of variance, so you can think of this as being similar to an analysis of variance. Which frequencies (inverse of period) contribute the most to the total variance in the time series?\nCircled regions indicate statistically significant regions of high power (using an AR1 as a null model)."
  },
  {
    "objectID": "amr.html#evolution-of-virulence",
    "href": "amr.html#evolution-of-virulence",
    "title": "9  Anti-Microbial Resistance",
    "section": "9.2 Evolution of Virulence",
    "text": "9.2 Evolution of Virulence\nSome plots from Frank (1996).\n\n## Figure 3 (Frank 1996)\nvstar &lt;- expression(s*(delta+gamma)/(r-s))\ns &lt;- seq(0,1,length=1000)\ndelta &lt;- 0.3\ngamma &lt;- 0.7\n\n## r=0.1\nr &lt;- 0.1\nvr01 &lt;- eval(vstar)\n\n## r=0.5\nr &lt;- 0.5\nvr05 &lt;- eval(vstar)\n\n## r=1.0\nr &lt;- 1\nvr1 &lt;- eval(vstar)\n\n## transmissibility is assumed to be a power function of virulence\n## beta(v) = b*v^s, s \\in (0,1)\n\nplot(s[vr1&gt;0],vr1[vr1&gt;0], log=\"y\", type=\"l\", lwd=2, ylim=c(0.1,100),\n     xlab=\"Transmission Exponent (s)\", ylab=\"Equilibrium Virulence (v*)\")\nlines(s[vr05&gt;0],vr05[vr05&gt;0], lwd=2)\nlines(s[vr01&gt;0],vr01[vr01&gt;0], lwd=2)\ntext(0.17,10,\"r=0.1\")\ntext(0.53,10,\"r=0.5\")\ntext(0.98,10, \"r=1.0\")\n\n\n\n\n\n## Frank (1996) figure 4 (kind of -- it's a cross-section of his false 3d plot)\nvstar1 &lt;- expression( (gamma*tau/r)^(1/(tau+1)) )\ntau &lt;- seq(0,4, length=1000)\ngamma &lt;- 0.5\n\n\nr &lt;- 0.1\nplot(tau,eval(vstar1), type=\"l\",  lwd=2,\n      xlab=expression(paste(\"Clearance Exponent (\", tau, \")\", sep=\"\")),\n      ylab=\"Virulence (v*)\")\n\nr &lt;- 0.5\nlines(tau,eval(vstar1), lwd=2)\n\nr &lt;- 1\nlines(tau,eval(vstar1), lwd=2)\ntext(3.5,1.98,\"r=0.1\")\ntext(3.5,1.4,\"r=0.5\")\ntext(3.5,1.21,\"r=1.0\")\n\n\n\n\n\n### Frank (1996) Figure 2\nlambda &lt;- 1\nk &lt;- seq(1,256, length=1000)\nm &lt;- 1.0\nrrr &lt;- expression( (k-(k-1)*((1-m)^2))^-1 )\nr &lt;- eval(rrr)\nvstar &lt;- expression( lambda*(1-r)/(lambda*(1-r) + r) )\npdf(\"superinfection.pdf\", height=5,width=8)\nplot(k, eval(vstar), type=\"l\", lwd=2, log=\"x\", xaxs=\"i\", ylim=c(0,1),\n     xlab=\"Strains per Host\", ylab=\"Virulence\")\n\n## m=0.1\nm &lt;- 0.1\nr &lt;- eval(rrr)\nlines(k, eval(vstar), lwd=2)\n\n# m=0.01\nm &lt;- 0.01\nr &lt;- eval(rrr)\nlines(k, eval(vstar), lwd=2)\n\n#locator(3)\nx &lt;- c(2.633309,  5.113474, 15.110922)\ny &lt;- c(0.73, 0.555, 0.33)\ntext(x[1],y[1],expression(m == 1))\ntext(x[2],y[2],expression(m == 0.1))\ntext(x[3],y[3],expression(m == 0.01))"
  },
  {
    "objectID": "amr.html#evolution-of-resistance",
    "href": "amr.html#evolution-of-resistance",
    "title": "9  Anti-Microbial Resistance",
    "section": "9.3 Evolution of Resistance",
    "text": "9.3 Evolution of Resistance\n\n\n\n\nFrank, S. A. 1996. “Models of Parasite Virulence.” Quarterly Review of Biology 71 (1): 37–78. https://doi.org/10.1086/419267.\n\n\nKremer, Michael, and Christopher M. Snyder. 2015. “Preventives Versus Treatments.” The Quarterly Journal of Economics 130 (3): 1167–1239. https://doi.org/10.1093/qje/qjv012."
  },
  {
    "objectID": "references.html",
    "href": "references.html",
    "title": "References",
    "section": "",
    "text": "Anderson, R. M., G. F. Medley, R. M. May, and A. M. Johnson. 1986.\n“A Preliminary Study of the Transmission Dynamics of the\nHuman Immunodeficiency Virus (HIV), the Causative Agent of\nAIDS.” IMA Journal of Mathematics Applied in\nMedicine and Biology 3: 229–63. https://doi.org/10.1093/imammb/3.4.229.\n\n\nAnderson, Roy M., and Robert M. May. 1991. Infectious Diseases of\nHumans: Dynamics and Control. Oxford: Oxford University Press.\n\n\nBaalen, M. van, and M. W. Sabelis. 1995. “The Dynamics of Multiple\nInfection and the Evolution of Virulence.” American\nNaturalist 146 (6): 881–910. http://www.jstor.org/stable/2463102.\n\n\nCohen, J. E., and R. E. Gürtler. 2001. “Modeling Household\nTransmission of American Trypanosomiasis.”\nScience 293: 694–98. https://doi.org/10.1126/science.1060638.\n\n\nDiekmann, O., and H. Heesterbeek. 2000. Mathematical Epidemiology of\nInfectious Diseases: Model Building, Analysis and Interpretation.\nNew York: Wiley.\n\n\nDiekmann, O., J. A. P. Heesterbeek, and J. A. J. Metz. 1990. “On\nthe Definition and the Computation of the Basic Reproduction Ratio\nR0 in\nModels for Infectious Diseases in Heterogeneous Populations.”\nJournal of Mathematical Biology 28 (4): 365–82. https://doi.org/10.1007/BF00178324.\n\n\nFerrari, M. J., S. Bansal, L. A. Meyers, and O. N. Bjornstad. 2006.\n“Network Frailty and the Geometry of Herd Immunity.”\nProceedings of the Royal Society B-Biological Sciences 273\n(1602): 2743–48. https://doi.org/10.1098/rspb.2006.3636.\n\n\nFine, Paul E. M. 1993. “Herd Immunity: History, Theory,\nPractice.” Epidemiologic Reviews 15 (2): 265–302. https://doi.org/10.1093/oxfordjournals.epirev.a036121.\n\n\nFrank, S. A. 1996. “Models of Parasite Virulence.”\nQuarterly Review of Biology 71 (1): 37–78. https://doi.org/10.1086/419267.\n\n\nGroenendael, Jan van, Hans de Kroon, Susan Kalisz, and Shripad\nTuljapurkar. 1994. “Loop Analysis: Evaluating Life History\nPathways in Population Projection Matrices.” Ecology 75\n(8): 2410–15. https://doi.org/10.2307/1940894.\n\n\nHeesterbeek, J. A. P. 2002. “A Brief History of R0 and a Recipe\nfor Its Calculation.” Acta Biotheoretica 50 (3):\n189–204. https://doi.org/10.1023/A:1016599411804.\n\n\nHeffernan, J. M., R. J. Smith, and L. M. Wahl. 2005. “Perspectives\non the Basic Reproduction Ratio.” Journal of the Royal\nSociety Interface 2: 281–93. https://doi.org/10.1098/rsif.2005.0042.\n\n\nHethcote, H. W., and J. A. Yorke. 1984. Gonorrhea: Transmission\nDynamics and Control. Vol. 56. Lecture Notes in Biomathematics.\n\n\nHill, A. N., and I. M. Longini. 2003. “The Critical Vaccination\nFraction for Heterogeneous Epidemic Models.” Mathematical\nBiosciences 181 (1): 85–106. https://doi.org/10.1016/S0025-5564(02)00129-3.\n\n\nHolt, R. D., A. P. Dobson, M. Begon, R. G. Bowers, and E. M. Schauber.\n2003. “Parasite Establishment in Host Communities.”\nEcology Letters 6 (9): 837–42. https://doi.org/10.1046/j.1461-0248.2003.00501.x.\n\n\nKucharski, Adam J., Kin O. Kwok, Vivian W. I. Wei, Benjamin J. Cowling,\nJonathan M. Read, Justin Lessler, Derek A. Cummings, and Steven Riley.\n2014. “The Contribution of Social Behaviour to the Transmission of\nInfluenza A in a Human Population.” PLOS\nPathogens 10 (6): e1004206. https://doi.org/10.1371/journal.ppat.1004206.\n\n\nLongini, Ira M., Eugene Ackerman, and Lila R. Elveback. 1978. “An\nOptimization Model for Influenza A Epidemics.”\nMathematical Biosciences 38 (1): 141–57. https://doi.org/10.1016/0025-5564(78)90023-8.\n\n\nMay, R. M. 1976. “Simple Mathematical-Models with Very Complicated\nDynamics.” Nature 261 (5560): 459–67. https://doi.org/10.1038/261459a0.\n\n\nMayr, Ernst. 1997. “The Objects of Selection.”\nProceedings of the National Academy of Sciences 94 (6):\n2091–94. https://doi.org/10.1073/pnas.94.6.2091.\n\n\nNold, Annett. 1980. “Heterogeneity in Disease-Transmission\nModeling.” Mathematical Biosciences 52 (3): 227–40. https://doi.org/10.1016/0025-5564(80)90069-3.\n\n\nOrroth, Kate K, Eline L Korenromp, Richard G White, Awene Gavyole, Ron H\nGray, Lawrence Muhangi, Nelson K Sewankambo, et al. 2003. “Higher\nRisk Behaviour and Rates of Sexually Transmitted Diseases in\nMwanza Compared to Uganda May Help Explain\nHIV Prevention Trial Outcomes.” AIDS 17\n(18): 2653–60. https://doi.org/10.1097/00002030-200312050-00013\n.\n\n\nRandolph, S. E., and A. D. M. Dobson. 2012. “Pangloss Revisited: A\nCritique of the Dilution Effect and the Biodiversity-Buffers-Disease\nParadigm.” Parasitology, 1–17. https://doi.org/10.1017/S0031182012000200.\n\n\nSalathé, Marcel, and Sebastian Bonhoeffer. 2008. “The Effect of\nOpinion Clustering on Disease Outbreaks.” Journal of the\nRoyal Society Interface 5 (29): 1505–8. https://doi.org/10.1098/rsif.2008.0271.\n\n\nSmaldino, Paul E., and James Holland Jones. 2021. “Coupled\nDynamics of Behaviour and Disease Contagion Among Antagonistic\nGroups.” Evolutionary Human Sciences 3: e28. https://doi.org/10.1017/ehs.2021.22.\n\n\nWoolhouse, M. E. J., L. H. Taylor, and D. T. Haydon. 2001.\n“Population Biology of Multihost Pathogens.”\nScience 292 (5519): 1109–12. https://doi.org/10.1126/science.1059026.\n\n\nWoolhouse, ME, C Dye, JF Etard, T Smith, JD Charlwood, GP Garnett, P\nHagan, et al. 1997. “Heterogeneities in the Transmission of\nInfectious Agents: Implications for the Design of Control\nPrograms.” Proceedings of the National Academy of Sciences of\nthe United States of America 94 (1): 338–42. https://doi.org/10.1073/pnas.94.1.338.\n\n\nYates, Terry L., James N. Mills, Cheryl A. Parmenter, Thomas G. Ksiazek,\nRobert R. Parmenter, John R. Vande Castle, Charles H. Calisher, et al.\n2002. “The Ecology and Evolutionary History of an Emergent\nDisease: Hantavirus Pulmonary Syndrome.” Bioscience 52\n(11): 989–98. https://doi.org/10.1641/0006-3568(2002)052[0989:teaeho]2.0.co;2."
  },
  {
    "objectID": "amr.html#the-crisis-of-antimicrobial-resistance",
    "href": "amr.html#the-crisis-of-antimicrobial-resistance",
    "title": "9  Anti-Microbial Resistance",
    "section": "9.1 The Crisis of Antimicrobial Resistance",
    "text": "9.1 The Crisis of Antimicrobial Resistance\nWhy do we have a crisis? A very real contributor to the problem relates to the economic incentives for pharmaceutical companies (Kremer and Snyder 2015).\nConsider a population of 100 people, 90 of whom have a low disease risk, say 10%. The remaining ten have 100% chance of getting infected. The infection generates harm equal to the loss of $100 and both treatment pharmaceuticals or vaccines are costless to produce, administer, and are 100% effective. Assume people are risk neutral and economically rational (big assumptions, I know).\n\n\n\n\n\nThis means 19 people will get infected on average.\nLow-risk population loses an expected $10 (10% chance x $100 loss). High-risk population loses $100.\nEconomic theory tells us that the low-risk people should be willing to pay $10 for a vaccine. Note also that the Pharma company doesn’t know a priori who is high-vs.-low risk. This means $10 x 100 = $1000 revenue.\nHowever, economic theory also tells us that anyone infected (regardless of their subpopulation) should be willing to pay $100 to treat their disease. This means $100 x 19 = $1900.\n\n\n\nDo the math, business geniuses."
  }
]